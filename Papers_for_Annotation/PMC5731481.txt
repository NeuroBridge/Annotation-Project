Real-time motion analytics during brain MRI improve data quality and reduce costs
Head motion systematically distorts clinical and research MRI data. Motion artifacts have biased findings from many structural and functional brain MRI studies. An effective way to remove motion artifacts is to exclude MRI data frames affected by head motion. However, such post-hoc frame censoring can lead to data loss rates of 50% or more in our pediatric patient cohorts. Hence, many scanner operators collect additional ‘buffer data’, an expensive practice that, by itself, does not guarantee sufficient high-quality MRI data for a given participant. Therefore, we developed an easy-to-setup, easy-to-use Framewise Integrated Real-time MRI Monitoring (FIRMM) software suite that provides scanner operators with head motion analytics in real-time, allowing them to scan each subject until the desired amount of low-movement data has been collected. Our analyses show that using FIRMM to identify the ideal scan time for each person can reduce total brain MRI scan times and associated costs by 50% or more.
1. Introduction
Head motion represents one of the greatest obstacles to collecting quality brain MRIs in humans. Head motion distorts both structural (T1-weighted, T2-weighted, etc.) and blood-oxygenation level dependent (BOLD) functional MRI data (task-driven [fMRI], resting state functional connectivity [rs-fcMRI]). It has been shown that even sub-millimeter head movements (i.e., micromovements) systematically alter structural and functional MRI data. Hence, much effort has been devoted to developing various effective post-acquisition methods for the removal of head motion artifacts from BOLD data.
Head movement from one MRI data frame to the next, rather than absolute movement away from the reference frame, accounts for the most significant BOLD signal distortions. Motion related artifacts are strongly correlated with measures of framewise displacement (FD), which represent the sum of the absolute head movements in all six rigid body directions from frame to frame. Recently, Ciric et al. directly compared the 14 most commonly used motion removal methods. Their benchmarking showed that post-hoc frame censoring techniques which remove data frames with FD values above a certain threshold are very effective for removing the residual relationship between motion and brain connectivity, as well as the distance dependence of this artifact. However, frame-censoring BOLD data based on FD comes at a steep price, because it necessarily involves data loss.
In our own pediatric patient cohorts, frame censoring excluded over 50% of rs-fcMRI data collected when using strict frame censoring criteria (FD > 0.2 mm, Supplementary Fig. 1; e.g.). The accuracy of MRI measures improves with longer data acquisition periods. Hence, a minimum number of data frames are required to obtain reliable estimates, leaving investigators committed to frame-censoring with a difficult choice – lose the participant completely or collect more data. This ‘overscanning,’ required to remove distance-dependent motion artifact while maintaining sample sizes, has drastically increased the cost and duration of brain MRIs.
Recently developed structural MRI sequences with so-called prospective motion correction use a similar frame-censoring approach to reduce the deleterious effects of head motion. These MRI sequences pair each structural data acquisition with a fast, low resolution snap shot of the whole brain (echoplanar image = EPI), which is then used as a marker or navigator for head motion. These motion-correcting structural sequences calculate relative motion between successive navigator images and use this information to mark the linked structural data frames for exclusion and reacquisition. In this manner, structural data frames are censored, which also increases the duration and cost of structural MRIs.
For both structural and functional MRI, access to real-time information about in-scanner head movement could greatly reduce the costs of MRI by eliminating the need for overscanning. Real-time motion monitoring would allow scanner operators to continue each scan until the desired number of low-movement data frames have been acquired (scanning-to-criterion). Even for investigators who do not implement frame censoring approaches, real-time motion monitoring would provide immediate, valuable information about scan quality. For example, access to accurate real-time FD data would enable scanner operators to intervene early on, if subjects are moving too much.
On many MRI scanners, operators can view EPI data (e.g. BOLD) on the console as they are being reconstructed. Unfortunately, the human eye cannot reliably detect the minute head movements (0.2 mm summed across all directions) that negatively affect MRI data. Thus, watching the raw EPI images on the console as they are being acquired is inadequate for making decisions about ongoing scans. Attempts have been made to acquire real-time proxies for FD using expensive cameras and lasers. Unfortunately, such proxies of head movement are only poorly correlated with FD because they cannot distinguish movements of the face and scalp from brain movement.
To simultaneously improve MRI data quality and reduce costs, we developed the easy-to-use Framewise Integrated Real-time MRI Monitoring (FIRMM) software suite, which calculates and displays FD values and summary motion statistics for brain MRI data in real time (Fig. 1, Supplementary Mov. 1). We focused on functional MRI data to develop and validate FIRMM, but it can be customized to monitor head motion during specialized structural MRI sequences that utilize navigators for motion correction.
Supplementary data related to this article can be found online at http://dx.doi.org/10.1016/j.neuroimage.2017.08.025.
FIRMM’s accuracy and cost savings were verified using several large rs-fcMRI data sets from different patient and control cohorts (1134 total scan sessions). First we characterized head movement (FD) for our Autism Spectrum Disorder (ASD), Attention Deficit Hyperactivity Disorder (ADHD), Family History of Alcoholism (FHA) and Control cohorts, using an Offline, post-hoc processing stream. Next we validated the accuracy of the FIRMM FD values by comparing them to those derived from the Offline processing stream. We then calculated the time savings generated when using FIRMM to scan to criterion. Finally, we tested FIRMM’s real-world utility and durability in a new cohort of 29 children and adolescents.
2. Materials and methods
2.1. FIRMM software suite
FIRMM is built using several software packages, each with a specific purpose, to make installation and usage easier and more reliable. Installation requires a Docker-capable Linux system. Operation on Ubuntu 14.04 and CentOS 7 operating systems have both been tested and work well. Installation is accomplished via a downloadable shell script which retrieves and installs FIRMM’s components. After installation FIRMM is launched with a shell script tailored to use a pre-built Docker image. FIRMM’s components are the compiled MATLAB (R2016b) binary backend which only requires an included MATLAB compiler runtime to run, shell scripts for image processing, a Docker image containing image processing software dependencies, and a Django web application front end. The compiled MATLAB binary backend monitors an incoming folder waiting for a new subfolder that has the current date and contains images created within the last few minutes. The backend does shell script image processing only on new functional images. The required image processing software is already installed and configured inside the Docker image. Results are visually displayed in the Django web application frontend as plots and tables in a Chromium web browser.
2.2. Real-time processing of DICOM images
As soon as each frame/volume of EPI (echo planar imaging) data is acquired and reconstructed into DICOM format, it is transferred to a pre-designated folder that the FIRMM software monitors for new images. On Siemens scanners, rapid DICOM transfer can be achieved by selecting the ‘send IMA’ option in the ideacmdtool utility (requires ‘advanced user’ mode). On Siemens scanners one can also use an MS-DOS batch script to add start ‘FIRMM’ and stop ‘FIRMM’ buttons to the scanner operating system. This package is a standalone script that can be downloaded with FIRMM.
FIRMM reads the DICOM headers and uses the header information to enter data sequentially into a job queuing system. DICOMs are processed in the temporal order they were acquired. FIRMM converts DICOMs into 4dfp format prior to any further processing. FIRMM realigns EPI data using the 4dfp cross_realign3d_4dfp algorithm. The cross_realign3d_4dfp algorithm run by FIRMM has been optimized for computational speed, thus frame-to-frame image intensity normalization has been disabled and the realigned data are not written out, only the alignment parameters. Alternative alignment algorithms operating on NIfTI format data can also be utilized and will be made available in future releases. The EPI images do not undergo pre-processing steps typically utilized in offline data analyses. For EPI images with a spatial resolution smaller than 4 mm3, data are down-sampled to 4 mm3 prior to realignment to increase processing speed.
2.3. Estimation of head realignments
Each data frame (volume) is aligned to the first frame of the run through a series of rigid body transforms, Ti, where i indexes the spatial registration of frame i to a reference of frame 1, starting with the second frame. Each transform is calculated by minimizing the registration error:   such that I(x⃗) is the image intensity at locus x⃗ and s is a scalar factor that compensates for fluctuations in mean signal intensity, spatially averaged over the whole brain (angle brackets). Each transform is represented by a combination of rotations and displacements. Therefore,
  with Ri representing the 3 × 3 matrix of rotations and ḋi representing the 3 × 1 column vector of displacements. Ri consists of the three elementary rotations at each of the three axes. Hence, Ri = RiαRiβRiγ and
2.4. Computation of framewise displacement (FD)
Calculating head realignment parameters across frames starting with the second frame generates six displacement vectors of head motion. We convert head motion to a scalar quantity with the formula, Displacementi = |Δdix| + |Δdiy| + |Δdiz| + |Δαi| + |Δβi| + |Δγi|, where Δdix = d(i−1)x − dix, Δdiy = d(i−1)y − diy, Δdiz = d(i−1)z − diz, and so forth. Rotational displacements are converted from degrees to millimeters by computing displacement on the surface of a sphere of radius 50 mm, which is approximately the mean distance from the cerebral cortex to the center of the head for a healthy young adult. Since we realign each data frame to the first frame, FD is calculated by subtracting Displacementi−1 (for the previous frame) from Displacementi (for the current frame).
2.5. Model for predicting framewise displacement (FD)
The head motion (FD) prediction algorithm is a linear model that updates with each new data frame (y = mx + b), where y is the predicted number of low-movement frames below a certain FD cutoff at the end of the scan or experiment, x is the consecutive frame count, and m and b are estimated for each participant in real time. A given frame is labeled as usable if the relative object displacement is less than a given FD threshold (in mm), using as reference the object’s position in the previous frame. The prediction algorithm is implemented in Python using the scikit-learn package (http://scikit-learn.org). The prediction algorithm outputs are displayed inside the ‘Predicted Duration to Scan Criteria’ box in FIRMM’s graphical user interface (GUI), as minutes until the user-specified data criterion is reached. FIRMM users can select three FD thresholds (in mm) and the desired amount of low-movement data (in min.) using a simple settings file.
2.6. Visualization of framewise displacement (FD) in real time
FIRMM uses a GUI designed with Django (https://www.djangoproject.com/) and Chart.js (http://www.chartjs.org/) to display FD traces and summary counts of data quality in real time. FIRMM continuously updates summary counts about the number of ‘high-quality’ low-movement frames already acquired (FD cutoff presets are 0.2 mm, 0.3 mm and 0.4 mm) in table format and as a color-coded bar graph. At the end of each data acquisition epoch (run) the summary counts for that run are displayed in a list that tabulates the summary head motion data for each run separately and for the sum of all the data acquired thus far in the active scanning session. FIRMM also displays predictions about how much longer a given subject will likely have to be scanned until the preset time-to-criterion (minutes of low-movement FD data) has been acquired. There is also a graph of the actual amount of time (in min and s) one has scanned ‘low-movement’ frames toward a preset criterion amount of time. Users are able to customize the FD cutoffs and data amount criterion by opening FIRMM in the settings mode (FIRMM -s). FIRMM can be run in the help mode by typing FIRMM -h.
2.7. FIRMM monitoring: scanner requirements
FIRMM requires an MRI scanner enabled to rapidly reconstruct and transfer BOLD images. FIRMM currently expects an EPI mosaic as provided by Siemens, but is customizable to work with non-mosaic formats (i.e. GE and Philips). FIRMM monitoring was developed and tested on Siemens 3T Tim Trio and Siemens 3T Prisma scanners at Washington University School of Medicine (WUSM) and Oregon Health & Science University (OHSU). Additional beta testing has been conducted as part of the Adolescent Brain Cognitive Development (ABCD) project at several MRI sites and is now being implemented as a core advancement for this national study of 10,000 children who will be scanned biannually over the next 10 years (http://www.ABCDstudy.org). FIRMM was expressly designed to also be compatible with General Electric (GE) and Philips MRI scanners and dedicated GE and Philips versions are under development. On Siemens scanners FIRMM monitoring can utilize the ideacmdtool SendIMA option with buffering disabled. Alternatively, rapid DICOM forwarding can also be built directly into Siemens sequences, or an MS-DOS batch can be used to insert FIRMM ‘start’ and ‘stop’ buttons into the operating system (stand-alone software that can be downloaded with FIRMM).
2.8. FIRMM works with a wide range of sequences and EPI image types
Today’s MRI data acquisition landscape is changing rapidly. With multiband imaging, EPI data for sequences such as BOLD can now be collected every few hundred milliseconds and at spatial resolutions as low as 2 mm isotropic. While our estimations of FIRMM-driven time savings and the initial live testing of FIRMM were conducted on single-band EPI data with TRs of 2.0–2.5 s, we have since verified that FIRMM works equally well with multiband EPI data acquired at spatial resolutions as low as 2 mm isotropic and with TRs as short as 700 ms.
For BOLD data with high multiband factors, small voxel sizes and short TRs, the rate-limiting step is image reconstruction from k-space data, not FIRMM’s FD calculations and predictions. While image reconstruction can take longer for these types of acquisition parameters, vendor software platforms are becoming faster. Siemens image reconstruction as implemented in VE11B and VE11C is fast enough for FIRMM FD calculations to keep up with the speed of data acquisition at TRs of 700 ms. In addition, we simulated even faster image acquisition rates (TRs down to 500 ms) and FIRMM was still able to keep up and deliver accurate real-time FD calculations.
In addition to providing real-time head motion information during EPI imaging (rs-fcMRI, fMRI) at various resolutions and TRs, FIRMM can also be used to calculate FD on the EPI motion marker or navigator images collected as part of novel motion-correcting structural sequences. Such navigator images are similar enough to other EPI images that FIRMM can monitor head motion as long as it receives the EPI navigator images in real time. This use case is planned for development in a later release.
2.9. FIRMM computer requirements
The only hardware requirement for running FIRMM is a Docker-capable Linux computer networked to the computer running the scanner operating system, which is already part of the typical setup for MRI scanners used in research. The FIRMM software is self-contained in a Docker image and does not require licenses or the installation of other software packages.
FIRMM has been most extensively used with a self-built computer running Linux (Ubuntu 14.04 LTS) and the following hardware specifications: Intel Core i7 4790 K 4.0 GHz processor, 16 GB DDR3 memory, Samsung 850 EVO 120 GB SSD and NVIDIA GTX 960 GPU.
2.10. FIRMM code availability
We are making the FIRMM software and manuals available on our website (http://www.firmm.us) and on the Neuroimaging Informatics Tools and Resources Clearinghouse (https://www.nitrc.org). Installation instructions for FIRMM can be found at: http://www.firmm.us. Detailed documentation is included with the software download.
2.11. Using FIRMM
We focused on making FIRMM as easy to launch as possible to minimize the time interval between subject arrival and starting the first run, which can reduce costs and increase the chance of getting through the entire protocol for longer scanning sessions, especially in special populations. In its current version, scanner operators open the FIRMM monitoring GUI by typing ‘FIRMM’ into the command line.
To start monitoring head movement in real time the scanner operator must open FIRMM and then click the ‘Start FIRMM’ button which will begin monitoring the backend JSON file for updates.
Once launched, FIRMM requires no additional inputs because it automatically detects the active MRI scanning session folder and monitors for new incoming EPI acquisitions, separating images into distinct runs. Should the scanner operator forget to launch FIRMM at the beginning of the scanning session, he or she can launch FIRMM at any point during the study and FIRMM will process all EPI images associated with the current session in the correct order until it catches up to ongoing image acquisition.
FIRMM automatically saves a log file for each run during a scanning session. Shutting down FIRMM only requires closing the FIRMM GUI window. All synced dicoms are automatically deleted from the host computer after 48 h.
2.12. FIRMM outputs
FIRMM saves a temporary processing folder per study using the DICOM header information. In that folder, FIRMM saves the head motion parameters and FD values associated with each data frame. FIRMM also generates and saves a JSON file of the full information displayed in the GUI at the conclusion of the scanning session. By loading the JSONs of completed scans, users are able to recreate the final FIRMM display of previous scan session. For each scanning session FIRMM also writes out a simple text log (.csv) containing each data frame’s FD value and the six underlying motion parameters. FIRMM users interested in using FIRMM’s motion numbers for data processing and denoising can either import them from the log files, or from the JSON files using the JQ command-line JSON processor (https://stedolan.github.io/jq/).
2.13. Future upgrades to FIRMM
As noted above, the current version of FIRMM is part of the standard acquisition protocol for the 21-site ABCD study that will collect MRI data (structural, task fMRI, and rs-fcMRI) from 10,000 children biannually over the span of 10 years, starting at the age of 9. We expect the ABCD study to provide a great deal of valuable feedback to further improve FIRMM’s utility. ABCD functional (fMRI, rs-fcMRI) and structural (motion-correcting T1, motion-correcting T2) data should allow us to further improve the accuracy of our head motion prediction algorithm in the age range under investigation.
FIRMM upgrades already under development are aimed at making it even easier to use and to broaden its capabilities. Hence, we are currently testing a version of FIRMM with interactive graphics that would further simplify its use by allowing the selection and deselection of specific individual scans for inclusion in the actual and predicted amount of low-movement data.
Planned future versions of FIRMM should also allow users to display DVAR (D for derivative of timeseries, VAR for RMS variance across voxels) as an additional EPI data quality metric. DVAR measures how much the whole brain signal intensity varies from each data frame to the next, independent of the source of signal change. DVAR traces are very sensitive to frame-to-frame head motion but in principle can also detect EPI signal aberrancies from sources other than head motion.
In addition to the 4dfp alignment algorithm currently implemented by FIRMM, future versions will allow scanner operators to choose between similar, but slightly different, EPI image registration methods for calculating FD (FSL, AFNI, SPM).
Options for feeding information about head motion back to the subject, post-run and/or in real time are undergoing testing. Those feedback approaches most effective at reducing head motion will also be built into future versions of FIRMM.
2.14. Validation data sets
For this study, extant rs-fcMRI data (Table 1) from a total of 1134 scanning sessions of children, teens, and young adults (447 female scans) with a mean age of 12.4 years (range = 7.2–19.6 years), were utilized to compare FIRMM’s FD calculations to standard offline methods (WashU 4dfp) and to estimate the scanning cost reductions had FIRMM been available at the time of scanning. These data came from two different data sets that were pooled for the purpose of this study. The same data were also used to validate FIRMM’s head motion prediction algorithm. These data included cohorts with attention deficit hyperactivity disorder (ADHD: 425 scanning sessions, 140 female), autism spectrum disorder (ASD: 84 scanning sessions, 17 female), a family history of alcoholism (FHA: 304 scanning sessions, 141 female) and age-matched neurotypical controls (Controls: 321 scanning sessions, 149 female).
The Human Investigation Review Board at OHSU (datasets 1, 2) approved the research. Written informed consent was obtained from respective parents and verbal or written assent was obtained from child participants.
2.14.1. ADHD, ASD, neurotypical controls (dataset 1)
The ADHD and ASD cohorts, alongside age-matched neurotypical controls, were recruited as part of two ongoing longitudinal studies in the Fair and Nigg laboratories. For neurotypical and ADHD participants, children were recruited from families who volunteered in response to mass mailings in the community. Their diagnostic grouping was carefully evaluated in best-estimate, multi-stage case finding procedure. Children were excluded if they did not meet criteria for ADHD or non-ADHD groups. Exclusion criteria were tic disorder, psychotic disorder, bipolar disorder, autism spectrum disorder, conduct disorder, major depressive disorder, intellectual disability, neurological illness, chronic medical problems, sensorimotor disability, significant head trauma (with loss of consciousness); or if they were taking psychotropic medications other than psychostimulants. Children were also excluded if they had contra-indications to MRI. Only right-handed children were included in the study. Children prescribed psychostimulant medications were scanned after a minimum washout period of five half-lives (i.e. 24–48 h depending on the preparation).
For ASD participants, diagnosis was determined by a multi-disciplinary clinical team that utilized the ADOS. All children also met ASD criteria on the ADI-R, using DSM-IV criteria. Children with ASD were also assessed for ADHD by the same research methods noted above. As above, children with ASD who were taking psychostimulant medications were allowed in but were washed out for a minimum of 24–48 h (depending on formulation) or at least 7 half-lives of the formulation (i.e. the period of time it takes the body to metabolize/excrete half of the dose of the medication) prior to neuroimaging. Children taking non-stimulant psychoactive medications (e.g. tricyclic antidepressants, SSRIs, MAO inhibitors, or antipsychotic medication and atomoxetine) were excluded from the study.
2.14.2. Family history of alcoholism, neurotypical controls (dataset 2)
Participants, ages 10–16 years, were recruited from the local community. Family history of alcoholism (FHA) positive youth were part of an ongoing longitudinal study in the Nagel laboratory and matched for demographic characteristics to family history negative participants (neurotypical controls). To determine eligibility, structured interviews were conducted by telephone with the youth and one of their parents [Structured Clinical Interview;]. Exclusionary criteria included: lack of information on family history, family history of psychotic disorders (i.e. schizophrenia or bipolar I), diagnosis of a DSM-IV psychiatric disorder [Diagnostic Interview Schedule for Children, Predictive Scales ], significant lifetime alcohol or substance use (>10 lifetime alcoholic drinks or > 2 drinks on any single occasion, > 5 uses of marijuana, > 4 cigarettes per day, any other drug use) [Customary Drinking and Drug Use Record;], neurological illness, significant head trauma (loss of consciousness > 2 min), serious medical conditions, intellectual disability or learning disability, prenatal exposure to drugs or alcohol, left-handedness [Edinburgh Handedness Inventory;], premature birth (<36 weeks), MRI contraindications, and pregnancy or possible pregnancy.
2.15. FIRMM usage testing
After applying FIRMM to the 1134 extant scans (data sets 1, 2), we tested FIRMM’s utility for scanner operators in a new cohort of 29 children (FIRMM testing dataset 3: 11 female, mean age = 11.5 years, age range = 5.9–15.9 years). The Washington University (WU) Human Research Protection Office approved the research. Written informed consent was obtained from respective parents and verbal or written assent was obtained from child participants.
A total of 29 children between the ages of 5–16 years old were recruited from the local community and underwent rs-fcMRI scanning for a study that provided access to FIRMM to the scanner operators (Table 2). Children were excluded for any contraindications to MRI. Being left-handed was not an exclusion criterion. All participants were native English speakers.
2.16. Validation and FIRMM usage testing data acquisition parameters
Dataset 1 and 2 participants were scanned on a Siemens Tim Trio 3.0 T Magnetom Tim Trio system (Siemens Medical Solutions, Erlangen, Germany) with a 12-channel head coil, located at OHSU’s Advanced Imaging Research Center. A high-resolution T1-weighted MPRAGE sequence was acquired (resolution = 1 × 1 × 1.1 mm). BOLD-weighted functional images were collected (along the anterior–posterior commissure) using T2*-weighted echo planar imaging (TR = 2500 ms, TE = 30 ms, flip angle = 90°, FOV = 240 mm2, 36 slices covering the entire brain, slice thickness = 3.8 mm, resolution = 3.75 × 3.75 × 3.8 mm). Three runs of 5 min of resting state BOLD data were acquired, during which participants were instructed to stay still and fixate on a white crosshair in the center of a black screen projected from the head of the scanner and viewed with a mirror mounted on a 12-channel head coil.
Dataset 3 participants were scanned on a Siemens Tim Trio 3.0 T Magnetom system (Siemens Medical Solutions, Erlangen, Germany) with a 12-channel head coil, located at WU’s East Building Imaging Center. A high-resolution T1-weighted MPRAGE sequence was acquired (resolution = 1 × 1 × 1 mm). Functional images were acquired using a BOLD contrast-sensitive echoplanar sequence (TE = 27 ms, flip angle = 90°, in-plane resolution 4 × 4 mm; volume TR = 2.5 s). Whole-brain coverage was obtained with 32 contiguous interleaved 4 mm axial slices. Participants completed up to seven 6.8 min BOLD runs. During two of seven runs participants were in the resting state, which consisted of viewing a centrally presented white crosshair (subtending < 1° visual angle) on a black background. During the other five runs participants watched brief movies and/or received visual feedback about their head motion.
2.17. Analyses comparing FIRMM and offline FD values
For all 1134 scan sessions FD values were calculated using FIRMM (see sections 2.2, 2.3, 2.4) as well as using a previously published Offline method. The differences between the FIRMM and Offline FD values are 1) that the FIRMM FD values are calculated on the ‘raw’ BOLD images, prior to de-banding and slice-time-correction, and 2) that the FIRMM FD values are computed from BOLD image alignments relative to the first data frame instead of the run’s middle frame (Offline). All other steps such as the estimation of head realignment (section 2.3) and the formula for calculating FD (section 2.4) are the same for the FIRMM and Offline methods.
For both FD calculation methods (FIRMM, Offline) the number of usable low movement frames were calculated for three commonly used stringent thresholds (FD < 0.2 mm, FD < 0.3 mm, FD < 0.4 mm). For the whole sample of 1134 scans the correlation in the percentage of usable low movement frames between FIRMM and Offline was calculated for each frame censoring threshold (Fig. 3, Supplementary Fig. 2.
2.18. Analyses estimating time savings generated by FIRMM
To estimate how much scan time could have been saved by using FIRMM to scan until each subject had acquired the desired number of frames below the FD cutoff (scanning-to-criterion), we generated low movement data (FD < 0.2 mm) accumulation plots for all 1134 scan session. These plots show the accumulation of low movement data (min., y-axis) relative to the time spent scanning (min.; x-axis) (Fig. 5a). We then generated low movement data accumulation plots for each of our cohorts (ASD, ADHD, FHA, Control) (Fig. 5b). In these plots the area under the curve represents the relative scan time savings (percent) when scanning-to-criterion instead of scanning all participants for 20 min. For those scan sessions with <20 min of collected data, we linearly extrapolated the accumulation of usable frames from the existing data (Fig. 5b). We also used the 1134 individual low movement data accumulation plots to calculate the time difference in time-to-criterion between the FIRMM and Offline methods (Supplementary Fig. 4).
3. Results
3.1. Head motion is greatest in young children, neuropsychiatric patients
MRI scans in demographic groups with very high head motion could potentially benefit greatly from utilizing FIRMM analytics. Therefore, we examined the effects of age, gender and different neuropsychiatric conditions on deleterious head motion in our set of 1134 scan sessions from subjects 7–19 years old (Fig. 2). Consistent with previous research, a multivariate linear regression analysis (GLM: age, cohort, gender) showed that mean FD values were significantly greater at younger ages (effect of age, F = 46.9, p < 0.00001). Patient and at-risk cohorts also had overall greater FD values than controls (effect of cohort, F = 17.8, p < 0.00001). In addition, males had significantly greater FD values than females (effect of gender, F = 4.8, p < 0.03) (Fig. 2b). These patterns held true when we conducted the same analyses using the percentage of low movement frames (FD < 0.2 mm, FD < 0.3 mm, FD < 0.4 mm) instead of mean FD (Supplementary Fig. 1).
3.2. Demographics are poor predictor of in-scanner head motion
If the inter-individual variance in FD within demographic groups were low, one could attempt to optimize MRI scan durations by simply using different run lengths for different demographic groups. Yet, our analyses showed the variance of mean FD values across subjects to be very high in all cohorts ranging from ~0.1 to 2.0 mm across the entire sample. Some very young patients (<8 years old) had almost no head motion (mean FD ~ 0.1 mm), while some typically developing adolescents had very high head motion (mean FD > 0.4 mm). Even though the GLM analysis showed that age, diagnosis and gender significantly affected mean FD values, these factors explained only 12% of the variance (R2 = 0.12) across subjects. The high degree of inter-individual variance in FD across all cohorts shows that demographic criteria are insufficient predictors of how much data must be acquired for a given participant in order to retain a minimum number of low-movement data frames (Supplementary Fig. 1).
3.3. FIRMM’s real-time FD calculations are accurate
FIRMM’s FD calculations are not only fast, but also accurate when compared to a commonly utilized Offline, post-hoc processing stream (Fig. 3). To test the accuracy of FIRMM’s FD calculations, we combined FD data from 1134 scan sessions from subjects across several pediatric patient or at-risk cohorts and age-matched controls between the ages of 7–19 years old (see Fig. 2). Across all subjects, the FD values calculated by FIRMM in real time strongly correlated with the post-hoc FD numbers generated by the Offline processing approach) with an r-value of 0.98. The correlation (r) between Offline processing and FIRMM in the percentage of low-movement frames with FD < 0.2 mm was also 0.98 (Fig. 3). This strong correlation between FIRMM and Offline processing in the percentage of usable low-movement frames was independent of the censoring threshold. At FD thresholds of 0.3 mm and 0.4 mm the correlation between FIRMM and Offline processing in the percentage of usable frames was 0.99 (Supplementary Fig. 2).
For scanning sessions with extremely high total movement (<25% low movement frames) FIRMM scored a slightly higher percentage of frames as low movement, while the opposite effect was noted for scan sessions with extremely low movement (>75% low movement frames; see Supplementary Figs. 3,4). Given that the correspondence between the FIRMM and Offline FD calculations is almost perfect, but not quite, we investigated whether one set of FD-values might be superior at removing distance-dependent head motion artifacts. The original analysis that revealed distance-dependent head motion artifacts plotted the pre/post frame-censoring changes in functional connectivity (Δr) against connection lengths (mm). Repeating the original distance-dependent artifact analysis with both the Offline and FIRMM FD numbers (FD < 0.2 mm) showed the same linear relationship between censoring-driven changes in connection strength (Δr) and connection length for both of them (Fig. 4).
3.4. Using FIRMM to scan until data criterion is reached reduces scan times
Extremely rigorous frame-censoring discards all data frames with an FD value > 0.2 mm. In order to obtain a reasonably stable estimate of a single subject’s functional connectivity matrix, many research groups, including ours, have been requiring at least 5 min of low-movement data per subject as our data criterion. If we apply this criterion to our entire sample of 1134 scan sessions, we find that collecting 20 min of rs-fcMRI data would have given us at least 5 min of low-movement (FD < 0.2 mm) data in 91% of participants (Fig. 5). However, for 76% of the participants we could have already stopped scanning after 10 min or less. For an additional 10% of the participants, we could have stopped data acquisition between 10 and 15 min. Another 5% of participants reached data criterion between 15 and 20 min of scanning.
Thus, if we had used FIRMM to scan each participant until they reached the data criterion (5 min. FD < 0.2 mm), we could have reduced the total rs-fcMRI scan time and associated costs for this sample by 57%. We could have saved ~217 h of scan time for the rs-fcMRI data alone. Even if we conservatively estimate total hourly MRI scanning charges at $600/hr (MRI scanner usage fees, scanner operator(s) salaries and benefits, study participant payments), scanning-to-criterion with FIRMM could have reduced rs-fcMRI data acquisition costs by ~ $130,000 (see Supplementary Discussion).
Recent research suggests that significantly more than 5 min of rs-fcMRI data are needed for precision functional mapping of individual brains. Increasing the rs-fcMRI criterion beyond 5 min (FD < 0.2 mm), would greatly increase MRI scanning costs and with it the potential cost savings from scanning-to-criterion with FIRMM.
FIRMM users scanning-to-criterion can export FIRMM’s motion numbers for post-hoc data denoising, including frame censoring. For FIRMM users who would rather process and denoise their data using the motion values automatically generated by an offline data analysis package, precise congruence between the FIRMM and other FD values is important. Therefore, we quantified the divergence in required scan times between our FIRMM and Offline methods for a range of criterion times (Supplementary Fig. 4). For each FIRMM low movement criterion time, we calculated how long subjects would have had to be scanned so that 95% of them also reached the same low-movement criterion time with the Offline method. Consistent with Fig. 3 and prior work these analyses showed that the Offline processing slightly underestimates motion for lower-movement scans, so that relatively low-movement scans that meet the FIRMM data criterion will also meet the same criterion for the Offline FD values (Supplementary Fig. 4a and b). For the highest movement subjects this effect was reversed in that the Offline processing slightly overestimated head motion compared to FIRMM. Since the extremely high movement scans retained in our data are typically excluded from published data sets, even without frame censoring, and should ideally be stopped early based on FIRMM’s real-time information, the slight divergence between FIRMM and Offline numbers for the very highest movement scans does not pose a practical problem.
3.5. Linear accumulation of low movement data allows prediction of time to criterion
To further improve FIRMM’s utility for reducing scan times and costs we built an algorithm that accurately predicts the required scan time until the low movement data criterion will be reached.
When creating this prediction algorithm, we started by visualizing the effects of time spent in the MRI scanner on head motion (Fig. 6a–c). Fig. 6a shows the concatenated mean FD traces for all scanning sessions that included at least 3 × 5 min rs-fcMRI runs. A few observations are noteworthy. First, in the higher moving clinical cohorts, mean FD values increased with time in scanner (Fig. 6a). There also appears to be a small “reset” in mean FD such that head movement is lower for the start of the next run relative to the end of the prior session. In contrast, for the lower moving control cohort, mean FD increased only minimally over time. The percentage of low movement frames (FD < 0.2 mm) for the entire cohort is shown in Fig. 6b, which indicates that the percentage of low movement frames (FD < 0.2 mm) across each cohort declined only minimally with time spent in the scanner. Fig. 6b suggests that the accumulation of low movement frames over time should be relatively linear, which is verified by the low-movement frame accumulation plot in Fig. 6c. The same observations hold true when analyzing median FD values instead of mean FD (Supplementary Fig. 4). Given these findings, we chose a basic linear model to make real-time predictions about how long each participant would need to be scanned in order to reach the data criterion specified by the FIRMM user (Fig. 6d). Using this model, we showed that after 100 data frames have been acquired, FIRMM makes accurate predictions about how much longer a participant must remain in the scanner in order to reach a certain number of low movement data frames (Fig. 6e). FIRMM’s continuously updating prediction algorithm displays an estimate of how much longer it will take to reach the pre-specified low movement data criterion (see Fig. 1). This feature is particularly helpful for very high head motion individuals, since it helps scanner operators estimate whether or not they will be able to collect the required amount of low-movement data during the allotted scanner time. Fig. 6f illustrates the robustness of the linear prediction algorithm.
3.6. Using FIRMM monitoring for the early termination of scans in very high movement subjects reduces aggregate scan time
FIRMM can generate additional scan time savings by allowing scanner operators to terminate scans early for those participants with extremely low likelihoods of ever reaching the data criterion. For example, in the ADHD cohort 40 out of 425 participants had provided only 2.5 min (60 frames) of usable, low-movement data after 15 min of scanning (Supplementary Fig. 1). For these high head motion subjects, even another 5 min of scanning would likely not have brought them to criterion and we could have stopped data collection after only 3 instead of 4 runs. Using FIRMM’s linear prediction module, we could have terminated rs-fcMRI scanning for some participants even earlier. In this manner, FIRMM allows MRI scanner operators to quickly move to the next MRI sequence in the study protocol or to simply terminate the entire experiment, thus saving the participant and operator valuable time.
3.7. FIRMM alerts scanner operators to unexpected changes in head motion
Testing the real-world utility of FIRMM in a new cohort of 29 children revealed additional benefits. For example, a fairly sudden and significant reduction in one participant’s FD values towards the end of a scanning session alerted the scanner operators to check on the participant who was found to have fallen asleep (Fig. 7a). FIRMM also allows experimenters to quickly test how different scanning conditions affect head movement in a given participant. In one participant (Fig. 7b) who underwent seven BOLD runs under slightly different conditions, it was immediately evident that one of the conditions (run #4) greatly increased head movement, while all other experimental conditions were well tolerated.
Other usage cases provided by beta testing centers included using FIRMM to provide specific post-run feedback about head motion to motivate participants. This usage included sharing the percentage of low-movement data frames over the speaker system or displaying the FIRMM GUI on the participant’s screen in the scanner room for feedback and training purposes.
4. Discussion
Brain MRI will continue to grow in importance for medical diagnostics and human neuroscience because of its versatility and favorable safety profile. Frame-to-frame head motion is one of the biggest problems for all brain MRI sequences, clinical or research. Current solutions for dealing with excessive head motion and distance-dependent artifact carry additional risks (sedation) and costs (sedation, post-hoc frame censoring). In order to improve medical care, we must improve our ability to obtain usable brain MRIs without sedation. To speed up the advance of human systems neuroscience we must simultaneously improve brain MRI quality while reducing its costs. By enabling scanning-to-criterion and real-time interventions to prevent head motion, FIRMM represents an initial step towards acquiring higher-quality brain MRIs at lower costs.
Previously, motion estimates for brain MRIs were typically analyzed offline, either after data collection was completed for a given subject, or more commonly in large batches after data collection for the whole cohort had been completed. Postponing head motion analyses until after data collection is expensive and risky, especially when scanning a previously unstudied patient population and after making changes to the data collection protocol or personnel. Researchers and clinicians need to know if a given patient or cohort has higher than expected movement before it is too late to intervene.
Our analyses of head motion in 1134 scanning sessions from children, adolescents and young adults show that the FIRMM-driven time savings, when scanning-to-criterion, ranged from 46 to 64% depending on the cohort. While these cost-savings are specific to frame-censoring, FIRMM’s benefits are not limited to the frame-censoring of functional or structural MRI data. Using FIRMM will reduce acquisition costs even if the post-acquisition processing to reduce motion distortions does not involve a frame-censoring step (e.g. acompcor, ICA-FIX, ICA-AROMA). FIRMM’s head motion prediction algorithm can save time and cost by allowing researchers to terminate scans early for those participants who are extremely unlikely to provide usable data in the available time period. Scanner operators can then decide whether to rebook that participant for a longer time slot or whether to forego further attempts at MRI scanning. While scanning-to-criterion and early termination of extremely high movement scans will generate important cost reductions, preventing head motion from distorting MRI data in the first place is always preferable.
FIRMM’s real-time information about head motion can be used to prevent head motion in two different ways: 1) By influencing the behavior of MRI scanner operators and 2) by influencing MRI scanning participant behavior. Scanner operators monitoring the FIRMM window for any sudden or unusual changes in head movement are able to interrupt such scans to investigate if the subject has started moving more because they have grown uncomfortable and whether a bathroom break, blanket, repositioning or other intervention could make them feel more comfortable.
FIRMM information can also be used to improve the participants’ motivation and ability to hold still. Simply informing scan subjects that their head motion will be monitored in real time might reduce motion in some participants. In addition, post-run feedback about motion on the preceding run might lead to further head movement reductions. Such post-run feedback can be transmitted verbally or by visually displaying aspects of the FIRMM output to the participant after each run. Finally, FIRMM can be used to provide real-time visual feedback about head motion in order to reduce participant motion. Real-time head motion feedback might alter functional MRI measures, but will not affect the underlying signal for structural MRIs with motion correction (navigator images). While all of the validations presented here relied on functional MRI data, FIRMM is customizable to operate on the EPI navigator images imbedded within motion-tracking structural MRI sequences.
While it is generally agreed upon that FD accurately estimates head motion during scan acquisition, slightly different methods for calculating FD are currently in use. We compared the calculation of FD currently implemented in FIRMM with the Offline method previously used in our laboratories. FD values generated by FIRMM differ from the Offline values in two ways: 1) FIRMM aligns all EPI images to the first frame of the run instead of the middle one, and 2) FIRMM operates on the raw images prior to debanding and slice-time-correction. Both of these processing changes should in principle be advantageous. We showed that the first frame of a run, on average, has slightly lower head motion (Fig. 6a), which slightly decreases the likelihood that the reference frame might become contaminated by head motion. In addition, Jonathan Power has argued that FD numbers need to be calculated on raw BOLD data (prior to debanding, slice-time correction), because temporal interpolation could dampen apparent head motion. Thus, FIRMM’s method of calculating FD values might in principle be preferable over our previous Offline approach.
Our comparisons between the FIRMM and Offline FD values showed that they are highly congruent (r = 0.98). We also compared the FIRMM and Offline FD values in their effectiveness for removing distance-dependent artifacts by repeating the original analysis used to first describe distance-dependent head motion artifact with our 1134 scan sessions. Frame-censoring based on the FIRMM and Offline FD values seemed to remove distance dependent artifact to an equal degree (Fig. 4). Therefore, it seems reasonable and possibly more technically accurate to utilize FD values calculated prior to debanding and slice-time correction.
Given that several other methods for calculating FD are currently in use (AFNI, FSL, SPM, etc.), we are planning on adding real-time versions of all commonly used FD calculation methods to future versions of FIRMM. In addition, we plan on benchmarking all of the real-time FD calculation methods against each other and their respective offline versions. Thus, future FIRMM updates will enable using one’s real-time FD calculation method of choice.
While frames with high FD values introduce some of the most significant artifacts into MRI data, removing them might not get rid of all distortions. It has been proposed that very large head movements can also distort subsequent data frames. Therefore, some research groups remove one or more additional frames following high movement frames, while others do not. At the moment FIRMM is able to perform analyses on the number of frames below a certain FD cutoff, but it cannot yet process more complex contingencies, such as removing n frames following a head movement of a certain magnitude. Thus, we are planning on releasing future versions of FIRMM that will allow scanner operators to input more complex frame censoring algorithms. Other factors such as chest movements, for example, can distort the magnetic field (B0) and induce artifacts. Therefore, future versions of FIRMM will also track DVARs, a measure of how much the whole brain signal intensity varies from each data frame to the next that is sensitive to other sources of artifact besides head motion.
In summary, we contend that MRI sequences of the future should always be coupled to a real-time quality control display for the scanner operator and include the option of feeding back information about data quality to the participant.
Supplementary Material
Author contributions
N.U.F.D and J.M.K. initiated the study. N.U.F.D, J.M.K., E.A.E., O.M.-D., R.L.K., A.N.V., A.Z.S. and D.A.F. developed FIRMM. J.M.K., E.A.E., O.M.-D., R.L.K. and A.N.V. wrote the FIRMM software code. J.M.K. and A.Z.S. improved the speed of FIRMM image registration. D.A.F., B.J.N., J.T.N contributed data sets #1 & #2, N.U.F.D., J.M.K., A.N., V.W., D.J.G. contributed data set #3. N.U.F.D., J.M.K., E.A.E., O.M.-D., R.L.K., A.N.V., A.Z.S., B.J.N., J.T.N., A.N., V.W., D.J.G and D.A.F. made essential contributions to the analyses of the validation data sets. N.U.F.D., J.M.K., E.A.E, R.L.K., A.N.V., A.N., V.W., D.J.G. and D.A.F tested the FIRMM software. N.U.F.D. and D.A.F supervised the project. N.U.F.D. and D.A.F. co-wrote the manuscript with essential input from all authors.
The ADHD-200 consortium: a model to advance the translational potential of neuroimaging in clinical neuroscience
Motion artifact reduction in pediatric diffusion tensor imaging using fast prospective correction
Real-time measurement and correction of both B0 changes and subject motion in diffusion tensor imaging using a double volumetric navigated (DvNav) sequence
A component based noise correction method (CompCor) for BOLD and perfusion based fMRI
Diffusion imaging with prospective motion correction and reacquisition
Aimed movements to visual targets in hemiplegic and normal children: is the “good” hand of children with infantile hemiplegia also normal?
Psychometric evaluation of the Customary Drinking and Drug Use Record (CDDR): a measure of adolescent alcohol and drug involvement
Correlates of success following treatment for adolescent substance abuse
Prospective motion correction of high-resolution magnetic resonance imaging data in children
Evaluation of denoising strategies to address motion-correlated artifacts in resting-state functional magnetic resonance imaging data from the human connectome project
Benchmarking of participant-level confound regression strategies for the control of motion artifact in studies of functional connectivity
Unraveling the miswired connectome: a developmental perspective
Prediction of individual brain maturity using fMRI
Distinct neural signatures detected for ADHD subtypes after controlling for micro-movements in resting state functional connectivity MRI data
Prospective motion correction and selective reacquisition using volumetric navigators for vessel-encoded arterial spin labeling dynamic angiography
Individual-specific features of brain systems identified with resting state functional correlations
Precision functional mapping of individual human brains
Multivariate pattern classification of pediatric Tourette syndrome using functional connectivity MRI
ICA-based artefact removal and accelerated fMRI acquisition for improved resting state network imaging
Effective preprocessing procedures virtually eliminate distance-dependent motion artifacts in resting state FMRI
Integrated strategy for improving functional connectivity mapping using multiecho fMRI
Prospective motion correction improves diagnostic utility of pediatric MRI scans
Functional system and areal organization of a highly sampled individual human brain
On the stability of BOLD fMRI correlations
The autism diagnostic observation schedule-generic: a standard measure of social and communication deficits associated with the spectrum of autism
Autism Diagnostic Interview-Revised: a revised version of a diagnostic interview for caregivers of individuals with possible pervasive developmental disorders
The DISC predictive Scales (DPS): efficiently screening for diagnoses
Neuroimaging informatics tools and resources clearinghouse (NITRC) resource announcement
Reduction of motion-related artifacts in resting state fMRI using aCompCor
The assessment and analysis of handedness: the Edinburgh inventory
A wavelet method for modeling and despiking motion artifacts from resting-state fMRI time series
A simple but useful way to assess fMRI scan qualities
Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion
Functional network organization of the human brain
Methods to detect, characterize, and remove motion artifact in resting state fMRI
Recent progress and outstanding issues in motion correction in resting state fMRI
Evaluation of ICA-AROMA and alternative strategies for motion artifact removal in resting state fMRI
ICA-AROMA: a robust ICA-based strategy for removing motion artifacts from fMRI data
Head motion during MRI acquisition reduces gray matter volume and thickness estimates
Automatic denoising of functional MRI data: combining independent component analysis and hierarchical fusion of classifiers
Impact of in-scanner head motion on multiple measures of functional connectivity: relevance for studies of neurodevelopment in youth
Heterogeneous impact of motion on fundamental patterns of developmental changes in functional connectivity during youth
Data quality influences observed links between functional connectivity and behavior
Statistical improvements in functional magnetic resonance imaging analyses produced by censoring high-motion data points
Longitudinal analysis of neural network development in preterm infants
Optimizing real time fMRI neurofeedback for therapeutic discovery and development
Assessing the performance of different DTI motion correction strategies in the presence of EPI distortion correction
Volumetric navigators for prospective motion correction and selective reacquisition in neuroanatomical MRI
Prospective motion correction with volumetric navigators (vNavs) reduces the bias and variance in brain morphometry induced by subject motion
The influence of head motion on intrinsic functional connectivity MRI
The WU-Minn Human Connectome Project: An overview
PROMO: real-time prospective motion correction in MRI using image-based tracking
A comprehensive assessment of regional variation in the impact of head micromovements on functional connectomics
Spurious group differences due to head motion in a diffusion MRI study
Appendix A. Supplementary data
Supplementary data related to this article can be found at http://dx.doi.org/10.1016/j.neuroimage.2017.08.025.
Framewise Integrated Real-time MRI Monitoring (FIRMM) graphical user interface. Sample data are from the Adolescent Brain Cognitive Development (ABCD) study and include both task fMRI and resting state runs.
Effects of age, diagnosis and gender on head motion. The mean FD values (y-axis; Offline) for 1134 MRI scan participants are shown relative to participants’ ages (x-axis). Within all cohorts there is massive inter-individual variance in head motion. (a) Shows the participants labeled by diagnoses (Controls, Family History of Alcoholism, Attention Deficit Hyperactivity Disorder (ADHD-200-Consortium) and Autism Spectrum Disorder [ASD]). (b) Shows the same data labeled by gender. At the top and to the right of each plot the histograms for each cohort are shown. Lines represent LOWESS with span of 0.5.
Comparison of FD values generated by FIRMM (red) and Offline approach (blue). FD data shown are from 1134 children and adolescents. (a) Shows the percentage of low movement data (FD < 0.2) for each participant included (y-axis), sorted by the mean percentage of low-movement frames across both methods for each participant (x-axis). (b) Shows the correlation (r = 0.98; linear fit and fit equation shown in green; identity line shown in black) between estimates of low-movement data as calculated by FIRMM (x-axis) and the standard offline post-hoc approach (y-axis).
Distance-dependent artifact removal when frame-censoring using Offline and FIRMM FD values. The analysis was implemented as originally published by using all possible functional connections for a canonical set of 264 regions of interest. The y-axis shows the difference in correlation strength for all functional connections when comparing the frame censored data with the original data (censored – uncensored). Connection lengths (rms distance in mm) are plotted on the x-axis. Within each cohort data were averaged across scanning sessions, prior to plotting. (a) Shows the effects of frame censoring (FD < 0.2 mm) when using the Offline FD numbers. (b) Shows the effects of frame censoring (FD < 0.2 mm) when using the FIRMM FD numbers.
Accumulation of low movement data (FD < 0.2 mm; FIRMM FD values). (a) This plot shows the accumulation of low movement data (min. FD < 0.2; y-axis) relative to the time spent scanning (min.; x-axis) for sample individuals from each of our cohorts. For standardization, we chose to display the accumulation plot for those participants at the 50th percentile of usable data after 15 min of scanning, for each cohort. (b) Shows the percentage of participants that have reached the chosen data criterion of at least 5 min of data with FD < 0.2 mm for each of our cohorts as well as the total sample (black). In this plot the area under the curve represents the relative scan time savings when scanning-to-criterion instead of scanning all participants for 20 min. Time savings would have been 57% for the entire sample (black), 63% for controls (green), 64% for FHA (purple), 51% for ADHD (blue) and 46% for ASD (orange).
Linear accumulation of low-movement data allows accurate prediction of time-to-criterion. (a) Shows the mean FD (FIRMM processing) for each cohort (FHA excluded because only 8 min of data were collected for most subjects) and the sample as a whole (black line) as a function of the time participants have already spent in the scanner. (b) Shows the % of data frames with FD < 0.2 at every time point in the scan for each of the cohorts. (c) Shows the relationship between the time scanned (x-axis) and the mean amount of low movement data (FD < 0.2) accumulated for each cohort (actual data shown with solid lines; linear fits shown with dashed lines). (d) Shows the FD trace for a single individual participant (black line) and compares it to the predictions FIRMM made at different points during the experiment (colored traces). (e) Shows FIRMM’s prediction error (in minutes; thick line) and actual data accumulation (thin black line) across the length of the scan (x-axis) for the same subject as in (d). (f) Shows FIRMM’s average prediction error (%) over time (x-axis) for each cohort and the entire group (solid lines), while the dashed lines indicate ± 1 standard deviation.
Sample FIRMM FD traces. For the MRI scans shown here, access to FIRMM’s real-time FD traces enabled scanner operators to intervene and improve MRI data quality. (a) Shows the FIRMM trace for a child who fell asleep towards the end of the scanning session. (b) Shows the FIRMM trace for a child who had much greater head movement for run #4.
Validation Data Demographics.
Cohort	Number of subjects	Female	Age range (yrs)	 	Control	321	149	7.5–19.0	 	FHA	304	141	11.9–19.6	 	ADHD	425	140	7.4–15.7	 	ASD	84	17	7.2–17.8	 		 	All	1134	447	7.2–19.6	 	
FIRMM Testing Data Demographics.
Number of subjects	Female	Age range (yrs)	 	29	11	5.9–15.9	 	
