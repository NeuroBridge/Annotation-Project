CLASSIFICATION OF SCHIZOPHRENIA AND BIPOLAR PATIENTS USING STATIC AND DYNAMIC RESTING-STATE FMRI BRAIN CONNECTIVITY
Recently, functional network connectivity (FNC, defined as the temporal correlation among spatially distant brain networks) has been used to examine the functional organization of brain networks in various psychiatric illnesses. Dynamic FNC is a recent extension of the conventional FNC analysis that takes into account FNC changes over short periods of time. While such dynamic FNC measures may be more informative about various aspects of connectivity, there has been no detailed head-to-head comparison of the ability of static and dynamic FNC to perform classification in complex mental illnesses. This paper proposes a framework for automatic classification of schizophrenia, bipolar and healthy subjects based on their static and dynamic FNC features. Also, we compare cross-validated classification performance between static and dynamic FNC. Results show that the dynamic FNC significantly outperforms the static FNC in terms of predictive accuracy, indicating that features from dynamic FNC have distinct advantages over static FNC for classification purposes. Moreover, combining static and dynamic FNC features does not significantly improve the classification performance over the dynamic FNC features alone, suggesting that static FNC does not add any significant information when combined with dynamic FNC for classification purposes. A three-way classification methodology based on static and dynamic FNC features discriminates individual subjects into appropriate diagnostic groups with high accuracy. Our proposed classification framework is potentially applicable to additional mental disorders.
1. Introduction
Functional connectivity (FC) can be quantified using a variety of different neuroimaging techniques. A commonly used measure is functional magnetic resonance imaging (fMRI), which measures synchronized brain activity via blood oxygenation and infers functional interactions among different brain regions. FC, defined as temporal correlation (or other types of statistical dependency) among spatially distant brain regions, has recently been used to examine the functional organization and temporal dependencies among these remote brain regions. Different analytic tools have been applied to resting-state fMRI data to describe brain functional connectivity. Two widely used FC approaches are (i) seed-based analysis and (ii) purely data-driven methods, such as ICA. FC can also be investigated at the network level using spatial independent component analysis (ICA), and connectivity among spatial components is referred to as functional network connectivity (FNC).
The majority of FNC studies are primarily based on the assumption that FNC is stationary throughout the entire scan session (or at least stationary during a given task or resting-state condition). Static FNC analysis overlooks the fact that individual subjects are likely to engage in slightly different mental activities at different instances in time. Also evidence of dynamic fluctuation in FC from several studies supports the idea of dynamic changes in FC during the experimental period. More recently, studies have started utilizing the powerful information contained within the temporal features of spontaneous FC of BOLD signals. Connectivity dynamics capture uncontrolled but reoccurring patterns of interactions among intrinsic networks during task engagement or at rest. These studies provide results that cannot be detected with static functional connectivity analyses.
There is an increasing interest in designing robust and accurate techniques to classify subjects into groups using functional imaging data. For example, previous studies showed the use of functional connectivity-based features for classification of schizophrenia and bipolar patients at the individual level. used an atlas-based method to extract mean time-courses of 116 brain regions in the resting-state for both healthy controls and schizophrenia subjects. The correlation between these time-courses made the feature vector for each subject. By applying feature selection and dimensionality reduction methods, they reduced the dimensionality down to three where they classified patients from controls with a high accuracy. proposed a classification approach for schizophrenia patients based on fMRI time-series from the voxels showing between-group temporal dissimilarity using leave-one-out cross-validation method. Another study combined both structural and functional MRI data for classification of schizophrenia patients and created a training set by projecting the high dimensional data onto a lower dimensional space using the principle component analysis (PCA), achieving a high classification accuracy. A recent study performed automatic classification of schizophrenia using both structural and functional MRI features, and showed that better classification accuracy could be achieved by using both MRI features, compared to using only a single feature. However, only a few studies have focused on classification analyses of both schizophrenia and bipolar disorder patients. In, temporal lobe and default mode networks were used as features using a leave-one-out cross-validation framework, and classified schizophrenia and bipolar patients at individual level. In another classification study, a support vector machine (SVM) was applied on the verbal fluency task-based patterns of regional brain responses to identify schizophrenia and bipolar patients at the individual level. To our best knowledge, no such study has provided a detailed comparison of both static and dynamic FNC features in a cross-validated classification analysis.
In this work, we conducted a classification study of schizophrenia, bipolar and healthy subjects using static and dynamic FNC features, as well as combined FNC features from both FNC analyses. Several previous studies have shown that schizophrenia and bipolar patients can be discriminated at group-level by using the information on dysfunctional integration of the brain.We hypothesized that disrupted functional integration in schizophrenia and bipolar patients as captured by FNC analysis reveal powerful information for automatic discriminative analysis at subject-level. We expected some connectivity measures to be better captured in a static model and others in a dynamic model. Static FNC provides information about the overall mean connectivity and may be more optimal for connectivity that is persistent across the entire experiment than a dynamic FNC approach. On the other hand, information on local connectivity changes at different time windows will be better captured by dynamic FNC. Thus, we hypothesize that both static and dynamic FNC methods capture complementary aspects of connectivity, and combining static and dynamic FNC features will improve classification performance beyond the achievable performance from each type of these features individually. We present machine learning techniques to effectively combine these two types of features for accurate classification of schizophrenia, bipolar and healthy controls.
2. Materials and methods
2.1 Participants
Before preprocessing, we had raw resting-state fMRI data from 273 subjects (HC= 135, SZ= 87 and BP=51). After matching for age, and based on our exclusion criterion (see section 2.3 for details), we eliminated 114 subjects from the final analysis and had 159 subjects in total. We assessed these 159 subjects comprising 61 screened healthy controls [HC, age 35.44 ± 11.57 (range), 28 females], 60 patients diagnosed with schizophrenia or schizoaffective disorder (SZ, age 35.85 ± 12.01, 13 females) and 38 bipolar subjects (BP, age 38.96 ± 10.90, 20 females), matched for age with no significant differences among three groups (age: p= 0.303, F= 1.2031, DF=(2,156)). Significant differences in sex among three groups were found (p= 0.002, = χ2= 11.81, DF=(2,156)). Diagnoses were based on detailed medical and psychiatric history, chart reviews, and the Structured Clinical Interview for DSM IV-TR Disorders. None were acutely ill at the time of scanning. The bipolar patients group consisted of a mixture of individuals experiencing psychotic and non-psychotic symptoms by history.
2.2. Data Acquisition
Resting-state fMRI scans were acquired at the Institute of Living, Hartford, CT, USA on a 3T Siemens Allegra head-only scanner with 40mT/m gradients and a quadrature head coil. T2* - weighted functional images were acquired using gradient echo planar imaging (EPI) method with repetition time (TR)=1.5 s, echo time (TE)=27ms, field of view=24 cm, acquisition matrix 64×64, flip angle=70 degrees, voxel size=3.75mm×3,75mm×4mm, slice thickness=4 mm, gap=1 mm, number of slices=29, 210 frames and ascending acquisition. Subjects were instructed to keep their eyes open, look at a fixation cross on a monitor display and to rest quietly during the scan session.
2.3 Data Pre-processing
Functional images were pre-processed using an automated pipeline based around SPM 5 (http://www.fil.ion.ucl.ac.uk/spm/software/spm5). Pre-processing included the removal of the first four image volumes to avoid T1 equilibration effects, realignment using INRIalign (http://www-sop.inria.fr/epidaure/Collaborations/IRMf/INRIAlign.html), slice-timing correction using the middle slice as the reference frame, spatial normalization into Montreal Neurological Institute (MNI) space (http://www.mni.mcgill.ca/), reslicing to 3 mm × 3 mm × 3 mm voxels, and smoothing with a Gaussian kernel (FWHM = 5 mm). Voxel timeseries were z-scored to normalize variance across space, minimizing possible bias in subsequent variance-based data reduction steps.
In order to limit the impact of motion we excluded from analysis subject data with a maximum translation of >2 mm or with signal-to-fluctuation-noise ratio (SFNR) <275. The final 159 subjects comprised of patient and control groups were age matched (matched age ranging from 17 years to 65 years).
Also, to analyze if there is any systematic difference in motion across the three groups, we have computed the mean framewise displacement (FD) (calculated as the total absolute displacement in all dimensions) for 159 subjects. Results from one-way ANOVA showed significant group differences in mean FD groups (P-value=0.0369). However, three outliers were identified from the healthy group (subjects with high mean FD values (mean FD>1mm.) After removing these three outliers, we checked for mean FD group differences, and found no significant group difference (p-value=0.3172). Additional post-processing steps were taken to mitigate against residual motion effects as described in section 2.4.
2.4 Group ICA and Post-processing
Imaging data were decomposed into functional networks using a group-level spatial independent component analysis (ICA). Group ICA was performed using the GIFT toolbox (http://mialab.mrn.org/software/gift/). In order to obtain functional parcellation, we used a high model order ICA (number of components, C=100) to decompose the functionally homogeneous cortical and subcortical regions exhibiting temporally coherent activity. In the subject-specific data reduction principle component analysis (PCA) step, 120 principal components were retained (retaining > 99% of the variance of the data). Group data reduction retained C= 100 PCs using the expectation-maximization (EM) algorithm as implemented in the GIFT toolbox. The Infomax ICA algorithm was repeated 20 times in ICASSO and the resulting components were clustered to estimate the reliability of the decomposition. Subject-specific spatial maps (SMs) and time-courses (TCs) were estimated using the GICA1 back-reconstruction method based on PCA compression and projection.
Additional post-processing steps including linear, quadratic and cubic detrending, multiple regression of the six realignment parameters and their temporal derivatives, interpolation of detected outliers, and low-pass filtering with a high frequency cutoff of 0.15 Hz were applied to the component TCs in order to remove trends associated with scanner drift and movement-related artifacts. We detected outliers based on the median absolute deviation, as implemented in 3D DESPIKE (http://afni.nimh.nih.gov/afni). Outliers were replaced with the best estimate using a third-order spline fit to the clean portions of the TCs. As a final step in post-processing, we normalized the variance of each TC, thus covariance matrices (below) correspond to correlation matrices.
2.5 FNC Estimation
2.5.1 Static FNC Estimation
The static FNC (SFNC) for each subject was estimated from the TC matrix, as the C×C sample covariance matrix.
2.5.2 Dynamic FNC Estimation
In addition to the standard FNC analyses, we computed correlations between ICN time-courses using a sliding temporal window (Tukey window) having a width of 33 seconds (22 times of TR); sliding in steps of 1 TR), resulting in W=180 windows to capture the variability in connectivity. To characterize the full covariance matrix, we estimated covariance from the regularized precision matrix or the inverse covariance matrix. Following the graphical LASSO method of, we placed a penalty on the L1 norm of the precision matrix to promote sparsity. The regularization parameter lambda was optimized separately for each subject by evaluating the log-likelihood of unseen data (windowed covariance matrices from the same subject) in a cross-validation framework. Final dynamic FNC (DFNC) estimates for each window were concatenated to form a C×C×W array representing the changes in covariance (correlation) between components as a function of time.
2.6 Classification Framework
We evaluated the classification performance for static FNC, dynamic FNC and a combination of both static and dynamic FNC (see Fig.2 for illustration of the proposed approaches). Our main focus was to extract reliable features from the FNC matrices and apply proposed classification methods, rather than investigating the performance on different classifiers. For all of the FNC-based classification approaches, we used a linear support vector machine (SVM) classifier to evaluate the classification performance. Also, to obtain the 10 groups in 10-fold cross-validation, one split was performed and those same folds were used for static, dynamic and combined classification approaches
2.6.1 Static FNC Approach
classification based on static FNC features
Estimate static FNC matrices for all the subjects using corresponding ICA time-courses.Define the 10-fold cross validation groups as GHC, GSZ and GBP by first performing a single split of the data into 10 folds, where each fold comprises 6 subjects from the healthy control group, 6 subjects from the schizophrenia group and 4 subjects from the bipolar group. These subjects form the testing set (16 testing subjects at each iteration). The remaining subjects comprised the training set for each iteration. Note that, this step is same for all classification algorithms.For dimensionality reduction and feature selection, apply double input symmetric relevance (DISR) method and select the top 100 static FNC features (FDISR).Using the selected FDISR features, train a linear SVM classifier.With the left out testing subjects in step 2, build the testing set and select those identified FDISR features using the DISR method.Classify the subjects in the testing set using the trained classifiers and record the classification performance.Return to step 3 and repeat step 3 through step 6 in order to iterate over all cross-validation folds.	 	
In order to reduce the dimensionality and extract reliable features from this high-dimensional feature vector, we used the double input symmetric relevance (DISR) method during the cross-validation step. DISR is a mutual information based method which is designed to extract features by finding a combination of variables that can return more information on the output class than the sum of the information returned by each of the variables taken individually. For classification using SFNC features, the DISR method was run once per cross-validation fold. We used a 10-fold cross-validation strategy for estimating the generalization error of the proposed classifier. The details on the feature selection process using DISR are given in the supplementary Figure S1 and supplementary section S1. In each cross-validation run, 100 features were selected using the DISR method from the training samples. A linear SVM classifier was then trained using the features from training data and then tested on held out testing samples (the same 100 features were selected from the testing data).  
2.6.2 Dynamic FNC Approach
Classification based on dynamic FNC features
Estimate dynamic FNC matrices for all the subjects using a windowed FNC approach Define the 10-fold cross validation groups as GHC, GSZ and GBP by first performing a single split of the data into 10 folds, where each fold comprises 6 subjects from the healthy control group, 6 subjects from the schizophrenia group and 4 subjects from the bipolar group. These subjects form the testing set (16 testing subjects at each iteration). The remaining subjects comprised the training set for each iteration. Note that, this step is same for all classification algorithms.Apply group-wise k-means clustering to the windowed FNC matrices of the training groups. Based on the elbow criterion, select the optimum number of cluster centroids per group (dynamic connectivity states). In our dynamic FNC analysis the optimum number of cluster centroids was 5 per group.Form a regression matrix, Rgroups×centroids with these group-specific cluster centroids.Regress out the windowed FNC matrices at each time points using the regression matrix. Record the beta coefficients, β, at each time window. In our analysis, we estimated and saved 15 β coefficients for each time window.Compute the mean β coefficients for all the time windows for each subject. In our analysis, we have 15 mean β coefficients for each subject. These mean β coefficients are the dynamic FNC features, FeatdFNC, for the classification analysis.Using these FeatdFNC features, train a linear support vector machine (SVM) classifier.With the left out subjects in step 2, build the testing set and select the testing features by computing mean β coefficients using the same approach as training data.Classify the testing subjects using the trained classifiers and record the classification performance.Return to step 3 and repeat step 3 through step 9 to iterate over all of the cross-validation folds.	 	
For classification using the dynamic FNC matrix, we also used a 10-fold cross-validation for estimating the generalization error. In each cross-validation run, we performed group-wise k-means clustering on dynamic FNC matrix from the training samples. For each of the three groups, we obtained 5 cluster centroids or states. We then grouped these states together and formed a regression matrix with 15 states in total. We call these 15 states the feature states. Note that at each time point the FNC matrix is assumed to be a linear combination of these states. Then for each FNC time point, we regressed out the dynamic FNC matrix against these 15 feature states and obtained the corresponding regression coefficients. We used the mean of these regression coefficients and finalized 15 features for each subject for classification. Details on dynamic feature selection method are provided in the supplementary section S2 and supplementary Figure S2. A linear SVM was then trained using the training features and then tested on held out testing samples.  
2.6.3 Combined Static and Dynamic FNC Approach
Classification based on both static and dynamic FNC features
Estimate both static and dynamic FNC matrices for all the subjects as mentioned in algorithm 1 and algorithm 2.Define the 10-fold cross validation groups as GHC, GSZ and GBP by first performing a single split of the data into 10 folds, where each fold comprises 6 subjects from the healthy control group, 6 subjects from the schizophrenia group and 4 subjects from the bipolar group. These subjects form the testing set (16 testing subjects at each iteration). The remaining subjects comprised the training set for each iteration. Note that, this step is same for all classification algorithms.To select static FNC features for the training set, follow these steps:	 	For dimensionality reduction and feature selection, apply double input symmetric relevance (DISR) method on the static FNC of the training set and select top 100 static FNC features, FeatsFNC.To select dynamic FNC features for the training set, follow these steps:	 	Apply group-wise k-means clustering to the windowed FNC matrices of the training groups. Based on elbow criterion, select the optimum number of cluster centroids per group (dynamic connectivity states). In our dynamic FNC analysis the optimum number of cluster centroids was 5 per group.Form a regression matrix, Rgroups × centroids with these group-specific cluster centroids.Regress out the windowed FNC matrices at each time points using the regression matrix. Record the beta coefficients, β, at each time window. In our analysis, we have recorded 15 β coefficients for each time window.Compute the mean β coefficients for all the time windows for each subject. In our analysis, we have 15 mean β coefficients for each subject. These mean β coefficients are the dynamic FNC features, FeatdFNC, for the classification analysis.Combine both FeatsFNC and FeatdFNC features for the training set, FeatsFNC+dFNCUsing these FeatsFNC+dFNC features, train a linear support vector machine (SVM) classifier.With the left out subjects in step 2, build the testing set and select the testing features as follows:	 	select same FsFNC features using DISR method as mentioned for the training data.select FdFNC features by computing mean β coefficients using the same approach as training data.Combine these FsFNC and FdFNC features for the testing setClassify the testing subjects using the trained classifiers and record the classification performance.Return to step 3 and repeat step 3 through step 7 to iterate over all of the cross-validation folds.	 	
For the combined static and dynamic FNC approach, 100 features from static FNC feature vector after dimensionality reduction (as mentioned above in static FNC approach section), and 15 beta coefficient features from the dynamic FNC after regression against the states (obtained similar way as mentioned in dynamic FNC approach section) were used for classification purpose. Also SVM classifiers and a 10-fold cross-validation strategy were applied in a similar way as mentioned above for other two classification approaches.  
3. Results
3.1 Intrinsic Connectivity Networks
ICA was successfully used to decompose the functionally homogeneous cortical and subcortical regions with temporally coherent activity. Out of the 100 components obtained, we characterized 49 components as intrinsic connectivity networks (ICNs) that depicted peak cluster locations in gray matter with minimal overlap with white matter, ventricles and edges of the brain and also exhibit higher low frequency temporal activity. We used the time-courses of these 49 ICNs to compute static and dynamic FNC matrices. The spatial maps of 49 ICNs identified with group ICA are shown in Figure 1. Intrinsic connectivity networks are grouped by their anatomical and functional properties, which include the following: sub-cortical (SC), auditory (AUD), visual (VIS), sensorimotor (SM), cognitive control (CC), default mode (DM) and cerebellar (CB) components. The observed ICN networks are very similar to those found in previous studies with low model order ICA as well as high model order ICA.
3.2 Static FNC Features Estimation
For the static FNC classification algorithm, first we computed the pair-wise correlation (covariance) between the time-courses of 49 ICNs for each subject. Thus, for static FNC, each subject has a feature vector containing 49C2=1176 elements, resulting in a high-dimensional FNC matrix for all the subjects (subject×FNC=159×1176). Out of these 1176 static FNC features, we then extracted top 100 contributing pair-wise correlations or static FNC features between ICNs using DISR. Figure 3 highlights the top 15 contributing features used from HC, SZ and BP groups for classification analysis using static FNC as well as the group differences among these features across three groups (for simplicity we are only showing top 15 static FNC features). Both positive and negative connectivity between these top components were found. This figure summarizes the connectivity strengths between the top component pairs, by dividing them into brain networks as mentioned in section 3.1. Here, static FNC component pairs that showed connectivity differences across groups (Figure 3(b)) include connectivity between putamen and inferior occipital gyrus (IOG), inferior temporal gyrus (ITG) and supramarginal gyrus, (SmG)), inferior frontal gyrus (IFG) and superior parietal lobule (SPL), interior parietal lobule (IPL) and middle cingulate cortex (MCC), lingual gyrus (LG) and supplementary motor area (SMA), insula and calcarine, and IOG and postcentral gyrus. Also, detailed information for each spatial map such as regions of activation, Brodmann area, volume and peak activation t-value and coordinates for top 15 components are provided in table 3.
3.3 Dynamic FNC Features Estimation
For dynamic FNC analysis, we first applied the sliding-window approach and computed the pair-wise correlation between the time-courses of 49 ICNs at each dynamic window (see section 2.5), resulting into a dynamic FNC matrix, (subject×time×FNC =159×180×1176). As mentioned in section 2.7.2, we then obtained the dynamic FNC features by regressing out the dynamic FNC matrix against the feature states (formed by the regression matrix) at each FNC time point, and computing the mean beta coefficients for each subject. For more details on dynamic FNC feature selection method, see supplementary section S2 and Figure S2.
The k-means clustering was applied and 5 centroids were obtained for each of the HC, SZ and BP groups at each CV run. For each of the groups and for each of the 5 dynamic states, we computed the correlation between dynamic states. These group-wise centroids almost always showed very high correlations across all the CV runs. Supplementary Table S1 provides the mean correlation for each of the dynamic states computed across 10 CV runs.
Figure 4 displays the training and testing dynamic FNC features. In figure 4A (top), the group-wise mean training beta coefficients and figure 4A (right) the bar plot showing group-wise mean training features (summary of the information provided in figure 4A (bottom)) for 15 feature states have been presented. While the plot on the top of figure 4 is showing the actual values, the bar plots are showing these information in an average sense. Recall that, we combined the 5 dynamic states for each group and formed a regression matrix with a total of 15 states (feature states) for all three groups. Based on the formation of our regression matrix, HC group is expected to dominate between state 1 and state 5 in terms of dFNC feature values. Similarly we expect the SZ and BP groups to show dominating dFNC feature values between state 6 and state 10, and between state 11 and state 15, respectively. We will also refer to the states ranging from 1 to 5 as HC feature states, 6 to 10 as SZ feature states, and 11 to 15 as BP feature states.
From Figure 4A (top), we can see that the HC group shows dominating mean beta values (i.e. more dynamic FNC feature values) for the HC feature states, and nearly zero for all other feature states. The bar plot in Figure 4A (bottom) also confirms this trend where the mean beta value of the HC group for the HC feature states is 1.26 and nearly zero for the SZ and BP feature states. It was expected that the SZ group would show dominating feature values in SZ feature states, and nearly zero values for other feature states. However, the SZ group shows a mean of 0.39 in HC feature states, 1.12 in SZ feature states, and negative −0.56 in BP feature states. Also in the bar plot, BP group shows a mean beta value of 1.16 in BP feature states.
Similar trends for mean dFNC features in the testing set were found, and shown in Figure 4(B). Here, from the bar plots, HC group shows a mean beta value of 1.26 in HC feature states and nearly zero value otherwise. Similarly, the SZ group showed a mean feature value of 0.18 for the HC feature states, 1.2 for the SZ feature states, and −0.24 for the BP feature states. Also, the BP group shows a mean beta value of 0.05 for the HC feature states, −0.02 for the SZ feature states, and 1.15 for the BP feature states.
3.4 Classification Framework
To determine the chance levels (supplementary Figure S3 and supplementary section S3) for individual classifier accuracy, we performed 300-run permutation tests. Our results show that, for classifiers using SFNC, DFNC and combined FNC features, the average accuracy is around 35% (SFNC=34.88%, DFNC=34.56% and Combined=34.82%), with p-values <0.005 for all three chance levels.
Table.1 shows the confusion matrices for proposed classification approaches using static, dynamic and combined FNC features. Also, using the confusion matrices we computed: overall classification accuracy, group-wise sensitivity, specificity, positive predictive value (PPV) and negative predictive value (NPV) with Wilson’s binomial 95% confidence interval (Table.2 and Figure 5). The p-values obtained using the proportion tests (see supplementary section S4 for details) among all classifiers and all statistical measures are reported in Table S2.
The static FNC approach shows an overall classification accuracy of 59.12% and confidence interval of [51.05, 66.84]. The dynamic FNC approach showed an overall classification accuracy of 84.28% and confidence interval of [77.67, 89.56]. The combined static and dynamic FNC approach showed an overall accuracy of 88.68% and confidence interval of [82.7, 93.15]. The results from the proportion tests for comparing different classifiers showed significant difference between static FNC and dynamic FNC (p-value=3.229 ×10−6), and static FNC and combined FNC (p-value=8.653 ×10−8) in terms of overall accuracy. However, no significant difference was found between dynamic FNC and combined FNC approaches ((p-value=0.541), suggesting that that static FNC does not add any additional information when combined with dynamic FNC for classification purposes. The results from statistical significance levels among three classifiers for these statistical measures are provided in Figure 5 and supplementary Table S2..
Also, to analyze if the systematic difference in motion (as mentioned in section 2.3) across the three groups (total 159 subjects) has significant contribution to the classification performance, we removed the three outliers (mean FD>1mm), and performed the classification analyses (static FNC, dynamic FNC and combined static and dynamic FNC approaches). The new classification results with 156 subjects (Table S3) were very similar to the original classification results. Our follow-up analyses show that the contributions of motion to the classification accuracy are 0.15% for SFNC, 0.31% for DFNC and 1.51% for combined FNC approaches.
4. Discussion
Our results suggest that, classification using dynamic FNC and static+dynamic FNC features significantly outperforms classification using static FNC features (p=3. 229×10−6 and p=8.653×10−8, respectively, for overall accuracy). This is also supported by non-overlapping confidence intervals (static FNC: ([51 67]; dynamic FNC: [78 90]; combined FNC: [83 93]). Several group-wise statistical measures (sensitivity, specificity, PPV and NPV) also showed that both dynamic FNC and static+dynamic FNC statistically outperformed static FNC measures. However, classification using dynamic FNC and static+dynamic FNC features didn’t show significant statistical differences in classification performance (p=0.541 for overall accuracy). Also, none of the group-wise measures showed statistical significance between dynamic FNC and static+dynamic FNC.
This study shows that using static and dynamic connectivity features we can reliably discriminate HC, SZ and BP at the individual subject-level. Previous studies showed group-level discrimination of schizophrenia and bipolar disorder from healthy control subjects by using disconnected FNC properties in these patient groups. Using FNC approaches, these studies have identified disrupted connectivity patterns in schizophrenia and bipolar patients during rest and task in several brain regions Also our previous work reported disrupted connectivity in several dynamic states for schizophrenia and bipolar patients.
Dynamic FNC provides the information about how the connectivity changes over time, rather than representing the mean functional connectivity. It provides the local functional connectivity at each time window. This is likely capturing important information that is missed in static FNC approach and indeed, the dynamic FNC approach provides the higher overall accuracy rate compared to the static FNC approach. Moreover, when both static and dynamic FNC features were combined, the classification approach achieved slight but not statistically significant improvement on overall accuracy rate, suggesting that static FNC features don’t add any significant information when combined with the dynamic FNC features for classification purposed.
In our classification approach using static FNC, top static FNC features show group differences in both connectivity strength (greater or weaker connectivity) and directionality of connectivity (positively or negatively connected). Note that, in this study we did not perform any univariate test between component pairs to investigate significant group differences. Our static classifier differentiates the subjects at a multivariate level by considering the whole pattern from static features.
From Figure 3, the component pairs that show differences in the directionality of connectivity between control and patient groups include inferior frontal gyrus (IFG: frontal component) and right superior parietal lobule (SPL; parietal component) (controls showing positive connectivity and both patient groups showing negative connectivity), left inferior parietal lobule (IPL; parietal component) and right middle cingulate cortex (R-MCC, default-mode component) (controls showing positive connectivity and both patient groups showing negative connectivity), lingual gyrus (LG; occipital component) and right supplementary motor area (SMA, frontal component) (controls showing positive connectivity and both patient groups showing negative connectivity), and left inferior temporal gyrus (ITG; temporal component) and left supramarginal gyrus (SmG; parietal component) (controls showing negative connectivity and both patient groups showing positive connectivity).
Another top component in Figure 3 that differentiated BP from HC and SZ groups is putamen tail and left inferior occipital gyrus (IOG; occipital component) (HC and SZ showing positive connectivity and BP showing negative connectivity). Other component pairs that showed differences in connectivity strength across groups include insula (temporal component) and right calcarine gyrus (HC showing greater connectivity, SZ showing weaker connectivity, and BP showing the weakest connectivity), and MOG and right calcarine gyrus (both patient groups showing greater connectivity than control group).
Note that, the temporal lobe has consistently been shown to play an important role in discriminating between healthy control subjects and patients with schizophrenia and bipolar disorder. Previous functional connectivity studies also showed abnormal fronto-temporal functional connectivity in schizophrenia. However, to further link the findings to prior literature and speculate about how connectivity in these top features relates to SZ symptoms, information such symptom profiles for SZ patients are required.
Interestingly, in the dynamic FNC classification approach, SZ shows dominating feature values for the non-SZ feature states (Figure 4). This supports the overlapping findings of the SZ group with both HC and BP groups. Our dynamic FNC approach was able to utilize this characteristic of the SZ group to reliably differentiate them from the HC and BP groups.
Figure 6 shows the 15 dynamic states averaged across 10-fold runs. These dynamic states show distinct patterns such as default mode network showing strong positive within-network correlation and negative between-network correlation with auditory, sensorimotor and cognitive control (state 1 and 5), negative correlation between sub-cortical and auditory, visual and sensorimotor networks (state 3). Among these dynamic states, several similar states were found in the previous studies. For example, similar dynamic states as states 1, 3 and 5 were found in (Allen et al., 2013).
Note that, the 15 dynamic states in Figure 6, which had played a significant role while obtaining dynamic features, were not the features that were used by the classifier (that is, the differences in pairwise correlation across different states and different groups were not used as dynamic features, rather the states were used as regression matrix while obtaining dynamic features or beta coefficients). In the higher dimensional space, our classifier separated the patterns from these 15 states, and computed the fitness score or beta coefficients.
5. Limitations and Future Directions
There are several methodological and experimental limitations associated with sliding-window analysis method and result interpretations. One issue for sliding-window analysis is the choice of appropriate window size. Is has been reported in that the ideal window size should be able to estimate FC variability, capture lowest frequencies of interest in the signal, and detect interesting short-term effects. Our dynamic FNC approach was based on an empirically validated fixed sliding-window of 22TRs (33sec) similar to that used in.Evaluation of changes across variety of window lengths performed using separate windows and comparisons with time-frequency approaches which do not require windowing at all will be interesting to examine in future work.
It is very difficult to make comparisons between different automatic classification approaches of mental disorders, as there are several limitations and considerations associated with these studies. Factors such as study size, MRI scanner parameters, nature of extracted features, type of classifier, medication and disease severity in the patient group effects the classification frameworks. Also, without standard training and testing datasets, comparison of different approaches based only on the classification accuracy rate becomes highly ambiguous. It would be interesting to compare classification performance for diagnosis using the DSM criteria versus a Biotype-style approach as promoted in the BSNIP study, where biological features are used as the initial classifier to derive new diagnostic entities not based on traditional clinical classifications of mental illness.
Also, potential factors such as awareness or subject’s anxiety level at the scanner were not available for our subjects. These factors could potentially contribute to effectively differential groups given that both awareness and anxiety are known to affect patterns of brain. Thus, the factors may be important and should be investigated in future studies, in order to fully interpret the results.
In this study we showed that both resting state static and dynamic FNC features could be successfully used for automatic discrimination between three groups including healthy controls, schizophrenia patients and bipolar patients. To the best of our knowledge this the first study using resting-state dynamic FNC features as well as combined static and dynamic FNC features to classify schizophrenia and bipolar patients. Here we separated the data into training and testing dataset during the cross-validation folds. Our approach has some bias as the whole dataset was first processed together, group ICA was performed together, and the FNCs were computed together. To resolve this issue, separate training and testing preprocessing, group ICA analysis and FNC computation is recommended. In an ideal case, the test data should be locked in during the whole training process. However, ICA is unaware of the class labels, and we are not using test class labels anywhere in the pipeline. Thus, performing a single ICA on the whole dataset doesn’t potentially bias the classification results. Also, given that we were interested primarily in a comparison of static, dynamic, and combined connectivity features, and all used the same input, this should have little to no impact on our results.
Supplementary Material
This is a PDF file of an unedited manuscript that has been accepted for publication. As a service to our customers we are providing this early version of the manuscript. The manuscript will undergo copyediting, typesetting, and review of the resulting proof before it is published in its final citable form. Please note that during the production process errors may be discovered which could affect the content, and all legal disclaimers that apply to the journal pertain.
References
The effect of model order selection in group PICA
Tracking whole-brain connectivity dynamics in the resting state
A baseline for the multivariate comparison of resting-state networks
An MRI study of temporal lobe structures in men with bipolar disorder or schizophrenia
Functional network connectivity during rest and task conditions: a comparative study
Classification of schizophrenia patients based on resting-state functional network connectivity
Dynamics of ongoing activity: explanation of the large variability in evoked cortical responses
Automatic Bayesian classification of healthy controls, bipolar disorder, and schizophrenia using intrinsic connectivity maps from FMRI data
Functional connectivity in the motor cortex of resting human brain using echo-planar MRI
Multisubject independent component analysis of fMRI: a decade of intrinsic networks, default mode, and neurodiagnostic discovery

A method for making group inferences from functional MRI data using independent component analysis
Functional brain networks in schizophrenia: a review
Modulation of temporally coherent brain networks estimated using ICA at rest and during cognitive tasks
Temporal lobe and "default" hemodynamic brain modes discriminate between schizophrenia and bipolar disorder
Temporal lobe and “default” hemodynamic brain modes discriminate between schizophrenia and bipolar disorder
The chronnectome: time-varying connectivity networks as the next frontier in fMRI data discovery
Comparison of PCA approaches for large N group ICA
Altered functional and anatomical connectivity in schizophrenia
Identification of Distinct Psychosis Biotypes Using Brain-based Biomarkers
Pattern of neural responses to verbal fluency shows diagnostic specificity for schizophrenia and bipolar disorder
Imaging human connectomes at the macroscale
Dynamic connectivity regression: determining state-related changes in brain connectivity
Functional connectivity in the developing brain: A longitudinal study from 4 to 9months of age
Consistent resting-state networks across healthy subjects
Comparison of multisubject ICA methods for analysis of fMRI data
User's guide for the structured clinical interview for DSM-IV axis II personality disorders: SCID-II
A combined structural-functional classification of schizophrenia using hippocampal volume plus fMRI activation. Engineering in Medicine and Biology, 2002
Reduced communication between frontal and temporal lobes during talking in schizophrenia
Spontaneous fluctuations in brain activity observed with functional magnetic resonance imaging
Sparse inverse covariance estimation with the graphical lasso
Beyond phrenology: what can neuroimaging tell us about distributed circuitry?
Dysfunctional connectivity in schizophrenia
Resting-state functional connectivity in neuropsychiatric disorders
Functional connectivity in the resting brain: a network analysis of the default mode hypothesis
Validating the independent components of neuroimaging time series via clustering and visualization
Resting-state networks show dynamic functional connectivity in awake humans and anesthetized macaques
Independent component analysis: algorithms and applications
A method for functional network connectivity among spatially independent resting-state components in schizophrenia
Temporal lobe structure as determined by nuclear magnetic resonance in schizophrenia and bipolar affective disorder
Reimagining psychoses: an agnostic approach to diagnosis
Functional segmentation of the brain cortex using high model order group PICA
Mining event-related brain dynamics
Differences in resting-state functional magnetic resonance imaging functional network connectivity between schizophrenia and psychotic bipolar probands and their unaffected first-degree relatives
On the use of variable complementarity for feature selection in cancer classification
Information-based modeling of event-related brain dynamics
Dynamic connectivity states estimated from resting fMRI Identify differences among Schizophrenia, bipolar disorder, and healthy control subjects
A method for evaluating dynamic functional network connectivity and task-modulation: application to schizophrenia
Discriminative analysis of resting-state functional connectivity patterns of schizophrenia using low dimensional embedding of fMRI
Classification of functional brain images with a spatio-temporal dissimilarity map
The tenth annual MLSP competition: Schizophrenia classification challenge
Correspondence of the brain's functional architecture during activation and rest
Network modelling methods for FMRI
Increased intrinsic brain activity in the striatum reflects symptom dimensions in schizophrenia
Reduced fronto-temporal connectivity is associated with frontal gray matter density reduction and neuropsychological deficit in schizophrenia
Discriminative analysis of non-linear brain connectivity in schizophrenia: an fMRI Study
Probable inference, the law of succession, and statistical inference
Alterations of fronto-temporal connectivity during word encoding in schizophrenia
Dynamic coherence analysis of resting fMRI data to jointly capture state-based phase, frequency, and time-domain information
Thresholded group mean spatial maps of 49 ICNs
Thresholded Spatial maps showing 49 independent components that were characterized as intrinsic connectivity networks (ICNs) that depicted peak cluster locations in gray matter with minimal overlap with white matter, ventricles and edges of the brain and also exhibit higher low frequency temporal activity.
An overview of proposed classification approach
Group independent component analysis (ICA) is used to decomposed resting-state data from 159 subjects into 100 components, 49 of which are identified as intrinsic connectivity networks (ICNs). GICA1 back-reconstruction method is used to estimate the subject specific spatial maps (SMs) and time courses (TCs). Static FC between components is estimated as the covariance of TCs, and used as features for classification. For classification using dynamic FNC features, dynamic FC is estimated as the series of regularized covariance matrices from windowed portions of each subject’s component TCs and then the matrices are aggregated across subjects. For combined approach, features from both static and dynamic FNC were used. Here, T: time, V: voxel, Yi = raw resting fMRI data, C = ICA components, i: subject index, Si: spatial maps, Ri: time-courses.
Connectograms showing top 15 static FNC features. (a) Group-wise Top 15 static FNC features obtained using DISR method for healthy control (HC), schizophrenia (SZ) and bipolar (BP) groups. (b) Difference in 15 static FNC features among the three groups using two-sample t-tests (not corrected for multiple comparisons). All of the component labels indicate the brain region with peak amplitude and should be considered as bilateral activation unless mentioned as left (L) or right (R). CB: cerebellum, SMA: supplementary motor area, SmFG: superior middle frontal gyrus, IFG: inferior frontal gyrus, R-MCC: right middle cingulate cortex, SmG: supramarginal gyrus, IPL: inferior parietal lobule, SPL: superior parietal lobule, LG: lingual gyrus, IOG: inferior occipital gyrus, MOG: middle occipital gyrus, STG: superior temporal gyrus, ITG: inferior temporal gyrus, MTG: middle temporal gyrus. See Table 3 for more detailed information on each intrinsic connectivity network (ICN).
Features for dynamic FNC classification approach
(A.) Mean training dynamic FNC features with their standard error are shown for all groups in the feature states The bar graph is showing how the mean beta values or the dynamic FNC training features behave for each group across all connectivity states in an average sense (B.) Mean testing dynamic FNC features with their standard error are shown for all groups in the feature states. The bar graph is showing how the mean beta values or the dynamic FNC testing features behave for each group across all connectivity states in an average sense
Performance evaluation of proposed classification approaches
Bar plots showing group-wise sensitivity, specificity and overall accuracy for static, dynamic and combined classification approaches. Bar plots showing group-wise performance evaluations on sensitivity, specificity and overall accuracy for static, dynamic and combined classification approaches with 95% confidence intervals and p-values indicating significant differences (when exist) for all the statistical measures.
Dynamic states for three groups
Centroids or the dynamic states obtained from k-means clustering for three groups, averaged across all 10 cross-validation folds. Here, intrinsic connectivity networks are grouped as: sub-cortical (SC), auditory (AUD), visual (VIS), sensorimotor (SM), cognitive control (CC), default mode (DM) and cerebellar (CB) components.
Confusion matrices using different FNC classification approaches
	Static FNC Approach(Predicted Class)	Dynamic FNC Approach(Predicted Class)	Combined Static andDynamic FNC Approach(Predicted Class)	 	TrueClass		HC	SZ	BP	HC	SZ	BP	HC	SZ	BP	 	HC	40	18	3	55	3	3	54	5	2	 	SZ	9	39	12	5	50	5	5	51	4	 	BP	7	16	15	4	5	29	1	1	36	 	
Performance evaluation of classifier using different FNC classification approaches
	Static FNC Approach	Dynamic FNC Approach	 	OverallAccuracy (%)CI (%)	59[51,67]	84[78,90]	 	Statistics byClass (%)	HC	SZ	BP	HC	SZ	BP	 	Sensitivity[CI]	66[52 77]	65[52 77]	39[24 57]	90[80 96]	83[71 92]	76[60 89]	 	Specificity[CI]	84[75 90]	66[55 75]	88[80 93]	91[83 96]	92[85 96]	93[87 97]	 	PPV[CI]	71[58 83]	53[41 65]	50[31 69]	86[75 93]	86[75 94]	78[62 90]	 	NPV[CI]	80[71 87]	76[65 84]	82[74 88]	94[87 98]	90[83 95]	93[86 97]	 	
	Combined Static and Dynamic FNCApproach	 	Overall Accuracy (%)CI (%)	89 [83,93]	 	Statistics by Class (%)	HC	SZ	BP	 	Sensitivity[CI]	89[78 95]	85[73 93]	95[82 99]	 	Specificity[CI]	94[87 98]	94[87 98]	95[90 98]	 	PPV[CI]	90[79 96]	89[78 96]	86[71 95]	 	NPV[CI]	93[86 97]	91[84 96]	98[94 100]	 	
Regions of activation, Brodmann area (BA), peak activation t-value and coordinates for top 15 static FNC feature components
ICN regions	BA	tmax	Peak (mm)	 	X	Y	Z	 	Subcortical Networks	 		 	Putamen (78)						 	R Putamen		63.69	30	0	3	 	L Putamen		58.30	−27	−6	9	 		 	Putamen (91)						 	L Putamen	34	73.94	−24	9	−6	 		 	Auditory Networks	 		 	STG (36)						 	L Superior Temporal Gyrus	41	50.57	−48	−30	12	 	R Superior Temporal Gyrus	13	39.86	45	−15	3	 		 	Visual networks	 		 	Lingual Gyrus (10)						 	L Lingual Gyrus	18	58.58	−12	−84	−12	 		 	Inferior Occipital Gyrus (11)						 	R Inferior Occipital Gyrus	18	54.54	−27	−99	−3	 	L Middle Occipital Gyrus	18	54.21	27	−99	−6	 		 	Cuneus (16)						 	L Cuneus	18	64.24	0	−81	24	 		 	Calcarine (29)						 	R Calcarine	30	62.36	12	−69	9	 		 	Inferior Occipital Gyrus (32)						 	L Inferior Occipital Gyrus	19	44.72	−36	−75	−3	 	R Fusiform Gyrus	18	17.32	30	−78	0	 		 	Lingual Gyrus (33)						 	R Lingual Gyrus	19	51.03	21	−54	−9	 		 	Middle Occipital Gyrus (54)						 	L Middle Occipital Gyrus	19	47.16	−33	−90	12	 	R Middle Occipital Gyrus	19	47.35	30	−93	12	 		 	Sensorimotor Networks	 		 	Postcentral (14)						 	L Postcentral Gyrus	4	51.81	−36	−24	51	 		 	Superior Medial Gyrus (27)						 	L Superior Medial Gyrus	8	43.82	3	30	54	 		 	SMA (35)						 	R supplementary motor area	24	43.01	12	−6	51	 		 	SupraMarginal (38)						 	L SupraMarginal Gyrus	3	45.53	−60	−21	36	 	R Postcentral Gyrus	3	40.27	57	−18	33	 	L Inferior Frontal Gyrus	44	21.43	−54	9	24	 	R Inferior Frontal Gyrus	9	15.86	60	12	27	 		 	Cognitive Control	 		 	Inferior Temporal Gyrus (64)						 	L Inferior Temporal Gyrus	37	47.57	−45	−54	−9	 	R Inferior Temporal Gyrus	37	20.76	54	−48	−9	 		 	Middle Temporal Gyrus (92)						 	R Middle Temporal Gyrus	21	51.20	57	−21	−9	 	L Middle Temporal Gyrus	21	41.31	−60	−30	−3	 		 	Superior Parietal Lobule (60)						 	R Superior Parietal Lobule	7	48.93	15	−51	63	 		 	Inferior Parietal Lobule (63)						 	L Inferior Parietal Lobule	40	47.00	−57	−42	36	 	R SupraMarginal Gyrus	40	47.42	57	−45	33	 	R Inferior Frontal Gyrus	47	16.04	51	18	−6	 		 	Inferior Frontal Gyrus (57)						 	R Inferior Frontal Gyrus	9	50.30	45	12	30	 	L Inferior Frontal Gyrus	46	30.38	−45	18	27	 	Right Inferior Parietal Lobule	40	16.96	36	−51	51	 		 	Insula Lobe (98)						 	R Insula Lobe	47	58.98	42	12	−3	 	L Insula Lobe	47	48.66	−39	18	−3	 		 	Default Mode Networks	 		 	Middle Cingulate Cortex (75)						 	R Middle Cingulate Cortex	31	59.83	6	−33	33	 		 	Cerebellar Networks	 		 	Cerebellum (3)						 	L Cerebellum (VIII)		56.24	−36	−54	−45	 	R Cerebellum (Crus 2)		21.93	42	−54	−39	 	
Highlights
Performed classification using features from both static and dynamic functional network connectivity changes in schizophrenia and bipolar disorder during rest
A three-way classification methodology based on static and dynamic FNC features discriminates individual subjects into appropriate diagnostic groups with high accuracy.
Classification using dynamic connectivity features has significantly higher predictive accuracy than static FNC.
Combining static and dynamic FNC features does not significantly improve the classification performance over the dynamic FNC features alone, suggesting that static FNC does not add significant information when combined with dynamic FNC for classification purposes.
