Predicting individualized clinical measures by a generalized prediction framework and multimodal fusion of MRI data
Neuroimaging techniques have greatly enhanced the understanding of neurodiversity (human brain variation across individuals) in both health and disease. The ultimate goal of using brain imaging biomarkers is to perform individualized predictions. Here we proposed a generalized framework that can predict explicit values of the targeted measures by taking advantage of joint information from multiple modalities. This framework also enables whole brain voxel-wise searching by combining multivariate techniques such as ReliefF, clustering, correlation-based feature selection and multiple regression models, which is more flexible and can achieve better prediction performance than alternative atlas-based methods. For 50 healthy controls and 47 schizophrenia patients, three kinds of features derived from resting-state fMRI (fALFF), sMRI (gray matter) and DTI (fractional anisotropy) were extracted and fed into a regression model, achieving high prediction for both cognitive scores (MCCB composite r = 0.7033, MCCB social cognition r = 0.7084) and symptomatic scores (positive and negative syndrome scale [PANSS] positive r = 0.7785, PANSS negative r = 0.7804). Moreover, the brain areas likely responsible for cognitive deficits of schizophrenia, including middle temporal gyrus, dorsolateral prefrontal cortex, striatum, cuneus and cerebellum, were located with different weights, as well as regions predicting PANSS symptoms, including thalamus, striatum and inferior parietal lobule, pinpointing the potential neuromarkers. Finally, compared to a single modality, multimodal combination achieves higher prediction accuracy and enables individualized prediction on multiple clinical measures. There is more work to be done, but the current results highlight the potential utility of multimodal brain imaging biomarkers to eventually inform clinical decision-making.
Introduction
Predictive data mining has become a powerful tool for researchers and clinical practitioners in medicine and neuroscience. It involves building and applying theory and methods that allow for effective creation, evaluation and selection of prediction models. Neuroimaging has greatly enhanced our understanding of the human brain and its variation across individuals (neurodiversity) in health and disease. However, most criteria that used to assess severity/prognosis of brain disorders are still primarily based on clinical judgment; thus, the subjective factors of the doctors cannot be avoided. In addition, the overlapped cognitive or behavior performance of several mental disorders emphasizes the inadequacy of a diagnosis based purely on symptoms or behaviors alone and highlights the need for objective imaging neuromarkers that can assist the timely diagnosis or treatment. Therefore, using brain-imaging data to identify the neuroanatomical basis of cognitive impairment or symptom changes in brain diseases is an important research topic, since it is helpful for better understanding of the pathophysiology underlying the illness.
Predictive data mining has become popular in neuroimaging studies in a recent decade, especially for mental disorders research. Recent studies have started to use machine-learning techniques to detect neuroimaging patterns that may predict cognitive or behavioral performance. And initial brain measures have indicated compelling potential to predict health-related outcomes. However, most predictive studies to date have only related variation in baseline brain measures to variation in subsequent outcomes, which could be described more as post-diction or correlation rather than prediction. There are, however, a few examples of studies that are indeed “predicting” specific values of the target measures. For example, Wan et al. has proposed an elegant regression model called CORNLIN that employs a sparse Bayesian learning algorithm to predict multiple cognitive scores based on 98 structural MRI regions of interests (ROIs) for Alzheimer’s disease patients. The polynomial model used in CORNLIN can detect either a nonlinear or linear relationship between brain structure and cognitive decline. Stonnington et al. adopted relevance vector regression, a sparse kernel method formulated in a Bayesian framework, to predict four sets of cognitive scores using MRI voxel based morphometry measures. Wang et al. and Zhang et al. employed multi-task learning strategies for selecting biomarkers that could predict multiple clinical scores, e.g., using ℓ2–norm coupled with ℓ1-norm in regression models or multi-task feature selection coupled with a support vector machine (SVM). Integrating and testing various types of baseline data available, Ye et al. applied sparse logistic regression with stability selection to ADNI (Alzheimer’s Disease Neuroimaging Initiative) data for robust feature selection, successfully predicted the conversion from MCI to probable AD and identified a small subset of bio-signatures.
Nevertheless, many works were limited to use of a single modality, without using cross information from multiple modalities or were focused on subgroup discrimination (“classification”) instead of the particular values of the measures. In addition, quite often the input feature dimensionality is restricted, e.g. based on ROI features derived from AAL (Anatomical Automatic Labeling) templates, but without performing whole brain voxel-wise searching because of the computational load. Hence, we are motivated to propose a generalized model that is able to predict explicit values of the targeted measures by whole brain voxel-wise searching via cutting-edge machine learning algorithms and by combining joint information from multiple imaging modalities. Based on this motivation, we could use purely data-driven techniques to estimate the cognitive scores symptom changes or to classify disease subcategories using MRI measures, providing a potentially biologically valid framework for understanding mental illnesses or for even predicting the progression of the disease. This is consistent with the scope of the research domain criteria (RDoC) project proposed by NIMH, which aims to develop new ways of classifying and clarifying the underlying causes of mental disorders based on dimensions of observable behavior and neurobiological measures.
Here, we aim to achieve two main goals: 1) Design a generalized prediction framework that can be widely employed in future studies. 2) Predict target clinical measures quantitatively and identify relevant neuromarkers that could be biologically meaningful on cognitive decline/functional deficits in schizophrenia (SZ). For real human brain imaging data, we applied the framework to 47 SZ patients and 50 healthy controls (HCs) to estimate their cognitive scores, measured by the “measurement and treatment research to improve cognition in schizophrenia” (MATRICS) Consensus Cognitive Battery (MCCB) and the patients’ symptom scores, measured by the positive and negative syndrome scale (PANSS), using features extracted from three modalities: fractional amplitude of low frequency fluctuations (fALFF) from resting-state functional MRI, segmented gray matter (GM) from structural MRI and fractional anisotropy (FA) from diffusion MRI.
Note that we used the same data set as used for, however, different than the previous study that investigated the multimodal covaried networks which were not only significantly correlated with cognitive composite scores, but also showed significant differences between schizophrenia and healthy controls; this study aims to explore an approach to multimodal imaging data that enables detection of neuroimaging patterns as well as the building of a prediction model of target measures, such as cognitive scores or symptom scores. The methods used are quite distinct, the former paper adopted multi-set canonical correlation analysis, a blind source separation approach applied to group level of subjects; while the current work utilized several machine-learning techniques, including feature selection, clustering, regression and cross-validation. Results suggest the proposed prediction framework shows great promise to produce precise and individualized estimates on multiple clinical measures. Hence it’s possible to use this tool to estimate the treatment outcome for an individual patient, e.g., remitter or non-remitter, based on observable imaging measures, similar to what did in, which could enable the clinician to realistically make the personalized medical decision before treating a patient. Therefore, this project will be one of few attempts to meet clinical challenges of making early intervention possible based on fundamental neuroscience.
Materials and methods
Theory development
The working flowchart of proposed prediction model is shown in Fig. 1, which uses three MRI measures as an example; but this surely can be extended to other measures or modalities. The basic idea and justification of each step can be described as follows: First, considering the individuality of the predicted measures (cognition, symptoms), we remove features with very few variability across all training subjects by relative standard deviation thresholding, then based on advanced feature selection method ReliefF, we are able to select a set of most relevant features to the predicted measures. Then data-driven spatial clustering was performed to obtain fewer ROI-based features by averaging of the clusters, of which one cluster may consist several parts of the brain regions parcellated by atlas-based template, such AAL template. Note that using brain regions segmented by atlas as features is an alternative in our prediction, whereas, our proposed method is a purely data-driven feature extraction via whole brain voxel-wise searching, and achieves a higher prediction accuracy compared to AAL atlas-based methods, see results and the supplementary file (Supplementary Table S4). After this, the ROI-based features of different modalities were combined to take advantage of the multimodal complementary information, and further refined by correlation-based feature selection (CFS), producing a feature subset before regression. This step is necessary; since spatial clustering and averaging generate ROIs that compared to voxel-wise features indicate decreased relevance to target measure and may contain redundant information. Finally, by cutting-edge multiple regression models, a combination of joint brain feature subsets is formed to best predict the targeted measures. Note that all above mentioned feature selection algorithms (ReliefF, CFS) and regression models can be found in WEKA, a powerful data mining software in Java with a collection of machine learning algorithms. We will also release our prediction toolbox in future.
To avoid introducing bias into the prediction, rigorous nested cross-validation was performed. First, we left one subject for testing and used the other 96 subjects for training; then in the training layer, the 96 subjects went through a 10-fold cross-validation in the regression analysis after initial feature selection and the multimodal combination as shown in Fig. 1. This loop was repeated 97 times to test all the subjects. Each time the results produced the predicted score for the left-out (test) subject, as well as the regression equation and the identified brain regions in each modality. Then, we calculate the accuracy of the resulting prediction and identify the frequently occurring brain regions. Finally, in order to get a single regression equation for the whole MCCB prediction, we also performed a 10-fold prediction using all subjects to illustrate the identified features and regression model, as shown in Fig. 3. Next we describe the details for each step.
Feature preprocessing
Generally speaking, specific features with only minor variation across all subjects will not be useful for prediction. By setting an appropriate threshold, we eliminate features with low standard deviation (std), which also helps reduce the dimensionality. This step is similar to variance-based thesholding that has been popularly used in DNA methylation pre-processing for dimension reduction. The std. threshold is set as   where “target” denotes the measure to be predicted. The necessity of this step is given in supplementary file, see Table S1.
Feature selection by regression ReliefF
After obtaining representative measures from each modality, we will estimate the relevance of each voxel-wise feature to the target measure by ReliefF to derive subset of features. For continuous response values here, regression ReliefF is adapted. When processing, assume the input feature matrix X is in dimension of subjects by voxels (N × L), ReliefF randomly selects one subject Ri and searches for its k nearest neighbor subjects Ij (j = 1,2…k) based on L1 distance. For one feature (voxel/attribute) A, if it is desirable for prediction, then a bigger distance between the selected subject Ri and its nearest neighbors Ij should correspond to farther values on their predicted measures. For short, ReliefF introduces a kind of probability that the predicted values of two participants are different. This probability can be modeled with the relative distance between the predicted values of two subjects, and then are used to estimate the importance (weight) of each feature for the regression.
Assume Ndc measures two nearest subjects (e.g., Ri and Ij) have different predictions, NdA[A] determines two nearest participants have different values for the voxel/feature A, PdC &dA[A] measures two nearest participants have different predictions and different values for voxel feature A. Ndc, NdA[A] and PdC&dA[A] were updated m times for all voxels. Finally, the weight for each feature A is defined as:  
While, the detailed updates for Ndc, NdA(A) and NdA(A)dC, as well as the Pseudo code of RReliefF can be found in.
Following regression ReliefF, every feature is assigned with a weight value statistically accounts for its relevance to the response values (prediction). By determining a certain output number according to the scree test (see more details in the supplementary file Supplementary Fig. S1), we can identify the most significant features in the dataset and use them as the representatives of the original voxels.
Spatial clustering
The voxels selected via ReliefF were in general distributed sparsely across the whole brain. Here we employ a 26-connected (3 × 3 × 3-1) neighborhood strategy for image dilation, a classic way to find connected voxels in 3D image. In our case, the voxels selected out by ReliefF is 1, and the other voxels are 0. The 26-connected neighborhood voxels are neighbors to every voxel that touches one of their faces, edges, or corners. These pixels are connected along either one, two, or all three of the primary axes. These new generated voxel clusters can be projected into their corresponding areas on a brain map, enabling a useful visualization of the results. Next, these clusters are treated as the elementary features, and the mean voxel values of each cluster represent the ROI-based feature value.
Feature fusion
Features selected from the above procedures are derived from a single modality, reflecting a view of either brain structure or function. By combining features of different modalities together in a joint analysis, potentially important variations or relationship that may only be partially detected by single modality could be revealed, and complementary information may be obtained for better prediction. At this step, in order to take advantage of joint information, all ROI-based brain features of 3 modalities were concatenated horizontally, to build a matrix in the dimension of Nsubjects by (Nfeat_fMRI + Nfeat_sMRI + Nfeat_dMRI) and then input to the feature subset selection.
Feature subset evaluation
Although voxel-wise features selected by ReliefF are important, after spatial clustering and extract mean of the clusters, some features may have little influence on the predicted attribute. To further remove the redundancy, correlation-based feature selection (CFS) is employed. In CFS, the worth of each subset of features is evaluated by considering the individual predictive ability of each feature along with the degree of redundancy between them. Subsets of features that are highly correlated with the predicted measure while having low inter-correlation are preferred. Such a feature selection can help reduce the size of the resulting knowledge structures based on multimodal features and further yield a concise and refined data set that significantly improves the prediction performance.
Regression analysis
Next, a final regression analysis that quantitatively captures correlations between target measures and selected brain features was implemented. If we have l, p, q number of features derived from fALFF, GM and FA, respectively, then the practical predicted values (not true target value) can be written as:  
To make a performance comparison between linear and nonlinear regressions, we adopt three models: multiple linear regression, pace regression (linear) and sequential minimal optimization regression (SMOreg) (non-linear), all of which can be called and implemented through WEKA too. The latter two models are briefly introduced as follows.
PACE regression
(Projection Adjustment by Contribution Estimation) has striking advantages over existing techniques for fitting linear models with a strong emphasis on dimensionality determination problem. Compared to classical ordinary least squares estimators that may fail to detect redundancy in a larger feature set, pace regression improves it by evaluating the effect of each variable and using a clustering analysis to improve the statistical basis for estimating their contribution to the overall regressions. Besides, pace regression adopts nonnegative-measure-based minimum distance method for solving the minority cluster problem. It can yield better prediction models with reduced model dimensionality, especially for high dimensional data. Detailed information can be found in.
Sequential minimal optimization regression
(SMOreg) is an iterative algorithm for solving the regression problem using support vector machines (SVM). SMOreg uses the same principles as the SVM for classification, except for applying a nonlinear polynomial kernel k(xi, xj)=(xi, xj)p with p = 2 to transfer features into higher dimensional space, to make it possible to perform the linear separation. The goal of SMOreg is to estimate a function that is as “close” as possible to target values and as “flat” as possible for good generalization. More details together with a pseudo-code can be found in. As an extension of the SMO algorithm proposed by for SVM classifier design, SMOreg overcomes the issue of an important source of confusion and inefficiency caused by SMO. It globally normalizes all attributes by default, with an excellent performance on handling big samples.
Human brain data
Participants
Participants included a total of 47 patients with a SCID-P based DSM-IV-TR diagnosis of schizophrenia and 50 age-matched HCs (Table 1). The study was IRB approved at all participating institutions: the University of New Mexico Hospital and the Albuquerque Veterans Administration Medical Center. Participants were free of any central neurological disorder or significant head trauma and have no current diagnosis of substance abuse (>6 months before enrollment, excluding nicotine). Patients were clinically stable with no recent medication change (>4 months prior to study enrollment) across the data collection period. HCs and their first-degree relatives had no history of psychiatric disorder.
Clinical measures
To measure the current cognitive functioning, a trained rater administered the MCCB within 1 week of imaging. A composite score was calculated via the MCCB scoring program, which is an equal weighting of seven MCCB domain scores and has been recognized as the optimal primary outcome measure. Compared with HCs, SZs achieved significantly lower scores in composite and all domains. Meanwhile, the PANSS was conducted to quantify symptom scores of patients. The negative PANSS scores and the MCCB composite were anti-correlated (R = −0.48, p = 0.0008) as expected. No significant correlation was found between MCCB composite and medication dose in SZ.
Imaging parameters
All subjects were scanned by fMRI, sMRI and diffusion magnetic resonance imaging (dMRI), which were collected on a 3-Tesla Siemens Trio scanner with a 12-channel radio frequency coil.
fMRI
Resting-state scans were a minimum of 5 min in duration (152 volumes). Subjects were instructed to keep their eyes open during the scan and stare passively at a presented fixation cross, as this facilitates network delineation compared to eyes-closed conditions and helps ensure that subjects are awake. Data were collected with single-shot full k-space echo-planar imaging with ramp sampling correction using the inter-commissural line (anterior commissure/posterior commissure) as a reference (TR = 2 s, TE = 29 ms, matrix size = 64 × 64, flip angle = 75°, slice thickness = 3.5 mm, slice gap = 1.05 mm, field of view (FOV) = 240 mm, matrix size = 64 × 64, voxel size = 3.75 × 3.75 × 4.55 mm3).
sMRI
A multi-echo MPRAGE sequence was used with the following parameters: TR/TE/TI = 2530/[1.64, 3.5, 5.36, 7.22, 9.08]/900 ms, flip angle = 7°, FOV = 256 × 256 mm, slice thickness = 176 mm, matrix size = 256 × 256 × 176, voxel size = 1 × 1 × 1 mm, pixel bandwidth = 650 Hz, total scan time = 6 min.
dMRI
Data were collected along the anterior commissure/posterior commissure line throughout the whole brain with the following parameters: FOV = 256 × 256 mm, slice thickness = 2 mm, number of excitations = 1, TE = 84 ms, TR = 9000 ms. A multiple channel radio frequency coil was used with generalized auto calibrating partially parallel acquisition (×2), 35 gradient directions, b = 800 s/mm2 and 5 measurements with b = 0.
fMRI preprocessing
The SPM8 software package (http://www.fil.ion.ucl.ac.uk/spm/software/spm8) was employed to perform fMRI preprocessing. Slice timing was performed with the middle slice as the reference frame. Images were realigned using INRI align. The fMRI data were then despiked to mitigate the impact of outliers and spatially normalized into the standard Montreal Neurological Institute space with slightly up-sampled to 3 × 3 × 3 mm3. We further regressed out six motion parameters, white matter (WM) and CSF in de-noising, and the mean frame wise displacements showed no significant group difference (mean of root of mean square frame-to-frame head motions assuming 50 mm head radius); HC: 0.224 ± 0.12 mm, SZ: 0.227 ± 0.12 mm, p = 0.91). Finally, data were and slightly subsampled to 3 × 3 × 3 mm3 and spatially smoothed with a Gaussian kernel with full-width half maximum (FWHM) of 8 × 8 × 8 mm3. For the rest-fMRI, we extracted the voxel-wise fALFF to generate a map for each subject.
dMRI preprocessing
Data were preprocessed by the FMRIB Software Library (www.fmrib.ox.ac.uk/fsl). All images were registered to the first b = 0 image by the FMRIB linear image registration tool. The preprocessing consisted of the following steps: (a) quality check, any gradient directions with excessive motion or vibration artifacts were identified and removed; (b) motion and eddy current correction; (c) correction of gradient directions for any image rotation done during the previous motion correction step; and (d) calculation of diffusion tensor and scalar measures such as FA, which were then resampled to 3 × 3 × 3 mm3 and smoothed by a Gaussian kernel with FWHM of 8 × 8 × 8 mm3.
sMRI preprocessing
Data were preprocessed using the SPM8 software package to segment the brain into WM, GM, and cerebral spinal fluid with unmodulated normalized parameters via the unified segmentation method. According to, the use of unmodulated GM maps is one of the optimal settings in voxel-based morphometry analysis. Then GM images were then resampled to 3 × 3 × 3 mm3 and smoothed by a Gaussian kernel with FWHM of 8 mm. Subject outliers were detected using a spatial Pearson correlation with the template image to ensure that all subjects were properly segmented.
Normalization
After preprocessing, the 3D brain images of each subject were reshaped into a one-dimensional vector and stacked, forming a matrix (Nsbj × Nvoxel) for each of the three modalities. These three matrices were then normalized to have the same average sum-of-squares (computed across all subjects and all voxels/locus for each modality) to ensure that all modalities had comparable ranges. Since SZ and HC were not perfectly gender matched in the current study, before prediction, the gender was regressed out to remove its potential influence on differences between groups, even though the correlation between gender and the MCCB composite score is not significant (r = 0.17, p > 0.05).
Individualized prediction
Matrices derived from the above processing could then be treated as the original feature sets, and the corresponding cognitive/symptom scores are treated as the targeted measures; together, they serve as input to the proposed framework. Take fMRI for example, thresholding by standard deviation will prune out almost half of the total number of features, and about thousands of features will be reserved after ReliefF. During spatial clustering, with voxels organized into larger clusters, the number of features will be reduced to dozens. Finally, the features from three modalities are combined into a concatenated feature matrix that is further refined via subset feature selection, resulting in 5–15 brain regions and achieving the final prediction equation by regression analysis. In the experiment, we predicted the MCCB composite score and two domain scores (social cognition and verbal learning) with rigorous cross-validation, then evaluated PANSS positive and negative scores to verify the validity and reliability of the proposed framework.
In order to ensure the validity of the detected features, we performed an unbiased prediction flow based on nested cross-validation (10 fold + leave one out) as shown in Fig. 1, the correlations and root mean squared errors between the predicted measures and the true values are calculated in both training and testing loops, as shown in supplementary Table S3. For each modality, we could get a set of ROIs that contribute to regression and occur frequently in all loops. Note that the regression models are different at each loop; in order to get one regression model for the whole prediction, we also performed a prediction of MCCB composite using all subjects with 10 fold cross-validation. In this prediction, although in ReliefF all the training subjects were used, the selected voxel-wise features were not directly input into the pace regression, instead, these voxels were spatially clustered and refined again. Such a flow actually reduced the degree of overfitting in the training. We want to check if the frequently occurred ROI features from unbiased tests are in consistence with what we obtained from the above processing. And as we tested, the results obtained from such a working flow, as shown in Fig. 3, are quite similar to what we got from the unbiased test, see Results section.
On the other hand, the proposed method enables data-driven, voxel-wise feature searching. Indeed, using brain regions segmented by an atlas, e.g., AAL, as features can be used as an alternative. For fair comparison, we also added an alternative prediction of MCCB by combining AAL features from GM and fALFF with LASSO (least absolute shrinkage and selection operator), which is a penalized linear regression model popularly used for feature subset selection and making relevant predictions. We did not use DTI data since the AAL parcellation is based on gray matter structure, which is not suitable for FA maps representing the white matter tracts. The correlation between predicted values with the ground truth, the root mean squared prediction error (RMSE) as well as the normalized root mean squared prediction error (NRMSE) were calculated for each method using the nested cross-validation (10 fold + leave one out), as listed in Table 3. It clearly indicates that the proposed method outperformed the others in all perspectives.
Results
Impact of feature selection options and method comparison
Table 2 compares the prediction accuracy on MCCB composite values, PANSS positive and negative scores using three regression models based on the proposed feature selection framework (the first 3 columns, ReliefF + CFS + regression). Results showed pace regression outperforms multivariate linear regression and nonlinear regression (SMOreg) in building a prediction model for the MCCB composite, achieving the highest correlation at r = 0.7033, while for PANSS prediction, the nonlinear regression model yields the best results with r > 0.7785 for both positive and negative scores. Since no single regression approach is clearly superior in all cases during prediction process, we will incorporate all three regression models into the prediction toolbox as options for users in our future work. In addition, to demonstrate the necessity of each feature selection steps, we also added the MCCB/PANSS prediction performance based only on SVOreg without employing different feature selection steps (the 4th column) and without CFS step (ReliefF + SMOreg, the 5th column). It’s clear that lacking any of the steps result in lower correlation with ground truth. Specifically, if using only SMOreg without feature selection, tens of thousands of voxels were used to build a regression, resulting in markedly worse estimation. Similarly, without CFS, an essential step to exclude redundant ROI features, correlations between the estimated scores and true MCCB/PANSS scores decrease substantially too. Besides, supplementary Table S1 shows that including a simple step, standard deviation thresholding, the prediction performance will be improved greatly compared to not use it, especially when the predicted target shows adequate individuality; since most of the stationary features across subjects will be removed at first. All above results demonstrated the validity of the proposed method for multiple predicting targets.
Table 3 indicates the performance of MCCB prediction using the atlas based features instead of voxel-wise searching, as well as comparison with alternative prediction methods. The fALFF and GM data were segmented into 116 ROIs for each subject based on automated anatomical labeling (AAL), and then input into 3 regression models similarly as we did in the proposed method. We also added an alternative prediction by combining AAL features with LASSO (least absolute shrinkage and selection operator), which is a penalized linear regression model popularly used for feature subset selection and making relevant predictions. We did not use DTI data here since the AAL parcellation is based on gray matter structure, which is not suitable for FA maps representing the white matter tracts. The correlation between predicted values with the ground truth, the root mean squared prediction error (RMSE) as well as the normalized root mean squared prediction error (NRMSE) (https://en.wikipedia.org/wiki/Root-mean-square_deviation) were calculated for each method using the nested cross-validation (10 fold + leave one out). As listed, the proposed method outperformed all other alternatives, suggesting that the proposed voxel-wise searching enables more flexibility and higher precision than atlas-based features in prediction. Finally, supplementary Table S2 recorded the training and testing results for MCCB composite prediction on both correlations and RMSE mentioned above, which indicated that there is no apparent overfitting in our processing.
Prediction of cognitive scores
Fig. 2 demonstrates the predicted cognitive scores for 47 SZs and 50 HCs with respect to their true values based on the flowchart shown in Fig. 1, with a correlation coefficient of r = 0.7033. The true MATRICS scores are HC: 50 ± 11 and SZ: 31 ± 16, while RMSE = 11, low enough to separate most of the two groups. As shown in Fig. 2(A), the predicted score accuracy (measured by 1-|1-predicted value/true value|) is >75% for 2/3 of the subjects and >90% for 1/3 of the subjects. Fig. 2(B) demonstrates the bootstrapping test result, which was performed 1000 times on all subjects, and the bootstrapped confidence interval was [0.5849, 0.8055] at 95%. Connections with a bootstrap ration over 3.0 were considered to be significantly correlated with the cognitive scores.
Table 4 lists the anatomical information and the occurring frequency of the identified brain ROI features for MCCB composite prediction in 97 loops. Brodmann areas (BAs) of the fALFF and GM features and the WM tracts (from the John Hopkins Atlas) overlapped with FA maps are listed according to their occurring frequency from high to low. The higher frequency, the more robustness and importance of the brain regions contribute to the prediction. Clearly, the left prefrontal gyrus (BA 6, 8), middle temporal gyrus (MTG, BA 21 22), visual cortex (BA 18,19), inferior parietal lobule (BA 7,40) and cerebellum are identified as the significant fMRI or sMRI regions contributing to cognitive composite prediction, while for dMRI, parts of superior longitudinal fasciculus, uncinate fasciculus (UF) and inferior longitudinal fasciculus (ILF) seem to play more important roles.
Fig. 3 illustrates the identified multimodal ROI features by using all subjects to build a single regression equation. The identified clusters in each modality as well as their weights resulted from the final pace regression model are demonstrated, including six fALFF clusters, four GM clusters and five FA clusters. The anatomical information of these 15 ROIs are listed in supplementary Table S3, which shows considerable overlaps with the ROIs listed in Table 4 from unbiased testing. More importantly, prediction accuracy is greatly improved by combining three MRI measures (i.e., r = 0.7033 using 3-way fusion compared to r = 0.5677 using only fALFF, r = 0.5678 using only GM and r = 0.3373 using only FA, respectively, as shown in Table 2), which is consistent with the known benefits of multimodal fusion. Besides the MCCB composite, there are 7 specific cognitive domains. The proposed method can actually predict all domains at an accuracy >0.6, here we chose one domain, social cognition, as an example. Its final correlation with ground truth is r = 0.7084 based on an fMRI–sMRI fusion (r = 0.4966 using only fALFF and r = 0.5633 using only GM). The selected fMRI regions included right MTG (BA 20, 21), parahippocampal gyrus and cerebellum, and sMRI regions included striatum, insula (BA 13); inferior parietal lobule (IPL, BA 39) and angular gyrus (BA 40), which are shown in supplementary Table S4.
Prediction of PANSS scores
The PANSS is a medical scale used for measuring symptom severity of patients with schizophrenia. To evaluate the stability and generality of the proposed framework from another perspective, the PANSS positive and negative scores were also predicted in this project, with r = 0.7785 and r = 0.7804 achieved respectively for all patients, suggesting excellent generalizability of the proposed framework. For both measures, fALFF-GM combination reached the best prediction instead of using three-way fusion (Table 2).
Table 5 provides the identified anatomical labels and occurring frequencies for fALFF and GM. With regard to PANSS positive scores, brain areas including cingulate gyrus, the striatum/thalamus/ parahippocampal gyrus and cerebellum were identified in fALFF, whereas the dorsolateral prefrontal cortex (DLPFC, BA10, 46), inferior parietal lobule (BA 39, 40) and cerebellum were identified in GM. While for PANSS negative scores, the striatum, superior frontal gyrus (BA 6) and cerebellum appear significant in both fALFF and GM.
Discussion
In this study, we proposed a generalized predicting framework that employs advanced data mining strategies to identify potential neuromarkers by whole brain voxel-wise searching, in which multimodal MRI information was combined to predict both cognitive and symptomatic scores. In addition, the important brain regions contributing to the regression model were also identified. Both the MCCB composite and PANSS predictions achieved correlations with ground truth >0.7, and more than 1/3 of the subject samples acquired score estimation with a 90% or higher correlation with true values, which proved the feasibility and the merits of the proposed framework. Note that this prediction framework can easily be generalized to other mental disorders and multiple brain imaging types.
Methodological issues
As a data-driven approach, the proposed method has a strength in searching neuromarkers from whole brain voxels within a short time, while most related studies often adopted predefined brain regions as features, such as those based on 116 AAL templates or 244 ROIs to reduce computational load. Though valuable information would be evident using larger ROIs, such methods do not exclude the possibility that some more focused abnormalities could be missed, as reported. By contrast, we adopted several advanced feature selection approaches, including ReliefF and CFS, to mine from tens of thousands of brain voxels efficiently, and the comparisons in Table 3 did show advantages of the proposed method. Compared with the majority of the heuristic feature selection measures (e.g., information gain, distance measure) that assume the conditional independence of attributes, ReliefF is aware of the contextual information; its computational complexity is polynomial and can correctly estimate data sets with dependent and independent attributes. Regarding parameter tuning, for all feature selection layers, only the ReliefF output needs to be tuned, which can be easily obtained by scree test, see more details in supplementary file. In our case, keeping 2000 ~ 5000 voxels after ReliefF is an optimal and reliable choice. Other feature selection stages can be implemented by WEKA with default settings (http://www.cs.waikato.ac.nz/ml/weka/index.html). And through the contrast tests in Table 2, we are convinced that each procedure designed for the prediction model adds value in terms of increased performance.
Another point worth noting is that multimodal fusion did improve the prediction performance in both cognitive and symptomatic scores; however, fusing as many modalities as possible in the training sample does not necessarily result in the best predicting results. To acquire a higher predicting accuracy and make a comparison among combinations of different modalities, we tested all possible modality combinations. As shown in Table 2, three-way fusion is optimal for MCCB composite prediction, whereas for PANSS, ALFF + GM is the best combination since FA map derives very low prediction. Compared to existing neuroimaging prediction studies that focus on single modality or single machine learning algorithms, like the framework proposed by, which used SVM to predict long-term treatment response of anxiety disorders via fMRI, or the approach described in, which can predict severity of depression for major depression disorders (MDD) using single MR structural scans, our data-driven framework makes the best use of the multimodal, sparse, precise yet imperative information, which proves to be flexible and fruitful for an informative understanding of brain activity and disorders.
Identified potential neuromarkers
As shown in Table 4, the higher occurring frequency, the greater impact of the brain ROIs contributing to the predicted measure. Note that left middle and superior temporal gyrus (BA 21,22) have the highest frequency in fMRI and also appears in sMRI. In addition, according to regression equation in Fig. 3, the lower fALFF and higher GM values in BA 21, the higher cognitive performance. This is consistent with findings in, where SZs showed dominant activities in the superior and MTG compared with HCs in the implicit memory retrieval tests.
Besides, left middle and medial frontal gyrus occurred in fALFF, which belong to DLPFC and positively correlates with the cognitive scores. Cognitive disorganization has been suggested as one cause of decreased activation in the prefrontal cortex, and DLPFC dysfunction has been related to attention deficits of schizophrenia. In addition, abnormal integration of frontal-temporal function, underpinned by a failure of normal cingulate cortical modulation, has also been demonstrated in patients. The significant brain imaging markers located by our regression model are consistent with the above reports.
Furthermore, the cuneus (BA 18, 19), which is most known for its involvement in basic visual processing, also occur in fMRI and sMRI. Since MCCB experiments include visual learning and attention tasks, it makes sense to identify the visual cortex as part of cognition prediction, and many studies have discovered that SZs present visual processing abnormalities in a variety of tasks. Moreover, the similar covariation between fMRI and sMRI suggests a synchronicity and complementary nature between structural and functional changes in cognitive impairment of schizophrenia, which is supported by.
With regard to WM assessment, we found the FA mainly lies in parts of WM tracts including the superior longitudinal fasciculus (SLF), UF, ILF, and forceps major/minor, similar to. Previous results have shown that FA changes in the SLF and SLFt, the major WM connection between the prefrontal and parietal/temporal cortices, relate to verbal working memory performance. also found early-onset schizophrenia adolescents exhibit lower FA in left ILF, and the FA values in left ILF predicted worse neurocognitive performance. Similarly, the uncinate fasciculus is suggested as a predictor of conversion from mild cognitive impairment to Alzheimer disease. All above reports support our findings that the identified WM tracts are associated with or predictive to cognitive impairment.
For MCCB social cognition domain, MTG (BA 20, 21), IPL and precuneus were highly correlated (Supplementary Table S4). IPL, particularly angular gyrus, is concerned with language, mathematical operations, perception of emotions and body image. have reported that damage to the frontal lobes can affect emotional responses to social stimuli and lead to the inability to recognize faces. Furthermore, the striatum and its cortical connections are critical for complex cognition, and lesions of it can affect various cognitive control processes. All of the identified regions are closely related with the measured MCCB domain social cognition.
When it comes to PANSS, related brain regions with great significance were revealed in striatum, DLPFC, IPL and cerebellum (Table 5). Note that the IPL reveals strong involvement in semantic processing, social cognition or theory-of-mind in several meta-analysis reviews. Hazlett, et al. recently reported that larger BA10 volumes in the DLPFC predict less symptom severity, and Kawada et al. found executive dysfunction scores were correlated with volume reduction in DLPFC in schizophrenia. The role of the cerebellum in schizophrenia has also been highlighted by Andreasen’s hypothesis of “cognitive dysmetria”, which suggests a general dyscoordination of sensorimotor and mental processes. In addition, thalamus, known for their functions in coordinating, planning and complex cognition, were demonstrated by patients in fMRI. Hence, all of the above brain regions identified in PANSS prediction are closely related to psychotic symptoms in schizophrenia.
Potential limitations and future directions
There are limitations of this study. First, no clear trend or characteristic was found to suggest which type of regression analysis is optimal, consistent with previous work. Both linear (multivariate linear regression and pace regression) and non-linear (SMOreg) regression were adapted in our study. Further studies are needed to clarify the utility of potential biomarkers in predicting cognitive/symptom performance identified here, which are closely correlated with cognition deficits in schizophrenia. Similar data from two or more sites are ideal for cross-validation. In addition, modalities adopted here can be extended to other types of data, such as genetic data, electroencephalograph (EEG) and PET, etc. Finally, as a general challenge for studying schizophrenia, most participants were receiving antipsychotic and/or mood stabilizing medication during the scanning course, which could result in both structural and functional brain alterations. Although we have not examined correlations between antipsychotic dose/gender with the identified brain features, the underlying effects of medication on imaging measures have been widely reported on fALFF, DTI as well as gray matter, future studies also need to consider the potential confound of gender effects.
In future work, the proposed method can not only be used for cognitive or symptomatic score prediction, but also be feasible to subcategory classification of mental disorders based on various imaging measures or genetic data. Even more, it can be used for treatment prediction, e.g., predicting that a major depression patient will be a remitter, responder or a non-remitter based on MRI scans before his electroconvulsive therapy, similar to what did in, implicating a wide applicability in the neuroimaging field.
In summary, we have developed and evaluated a novel, generalized framework that is able to predict explicit values of targeted measures precisely by using multiple imaging modalities and several superior machine learning approaches. In real application, it was applied to a combination of multiple MRI measures to predict both cognitive and symptomatic scores for schizophrenia and healthy controls. By searching the whole brain voxels, the framework not only achieved relatively higher predicting accuracy for multiple measures, but also demonstrated strong robustness to identify potential biomarkers. In brief, the proposed data-driven framework will be very useful for generating quantitative predictive markers, which can help translate neuroimaging observations into treatment decisions for individualized mental disorders, and thus is possible to lead to correct early intervention and better outcomes.
Supplementary Material
The authors report no financial relationship with commercial interests.
Neuroprediction of future rearrest
A baseline for the multivariate comparison of resting-state networks
“Cognitive dysmetria” as an integrative theory of schizophrenia: a dysfunction in cortical–subcortical–cerebellar circuitry?
Single subject prediction of brain disorders in neuroimaging: promises and pitfalls
Abnormal resting state FMRI activity predicts processing speed deficits in first-episode psychosis
Unified segmentation
The MATRICS Consensus Cognitive Battery (MCCB): clinical and cognitive correlates
Digital Topology in Brain Image Segmentation and Registration
Discrete Bayesian network classifiers: a survey
Where is the semantic system? A critical review and meta-analysis of 120 functional neuroimaging studies
A 4.0-T fMRI study of brain connectivity during word fluency in first-episode schizophrenia
Factor structure of the MATRICS Consensus Cognitive Battery (MCCB) in schizophrenia
Feature-based fusion of medical imaging data
Extracting Intrinsic Functional Networks with Feature-based Group Independent Component Analysis
Multimodal fusion of brain imaging data: a key to finding the missing link(s) in complex mental illness
Imaging the developing brain: what have we learned about cognitive development? Trends Cogn
Multimodal MRI in neurodegenerative disorders
Brain imaging correlates of depressive symptom severity and predictors of symptom improvement after antidepressant treatment
Subband weighting with pixel connectivity for 3-D wavelet coding
Phase-specific brain change of spatial working memory processing in genetic and ultra-high risk groups of schizophrenia
Functions of frontostriatal systems in cognition: comparative neuropsychopharmacological studies in rats, monkeys and humans
Reduced fMRI activity predicts relapse in patients recovering from stimulant dependence
The RDoC framework: continuing commentary
Evidence of diagnostic specificity in the neural correlates of facial affect processing in bipolar disorder and schizophrenia: a meta-analysis of functional imaging studies
Robust relief-feature weighting, margin maximization, and fuzzy optimization

A fast and efficient method to compensate for brain shift for tumor resection therapies measured between preoperative and postoperative tomograms
The value of the CRB65 score to predict mortality in exacerbations of COPD requiring hospital admission
Prediction of human errors by maladaptive changes in event-related brain networks
White matter abnormalities and cognitive impairment in early-onset schizophrenia-spectrum disorders
Abnormal cingulate modulation of fronto-temporal connectivity in schizophrenia
Data mining in bioinformatics using Weka
What is the best similarity measure for motion correction in fMRI time series?
Spatial registration and normalization of images
Prediction as a humanitarian and pragmatic contribution from human cognitive neuroscience
When the brain loses its self: prefrontal inactivation during sensorimotor processing
Test–retest reliability and feature selection in physiological time series classification
Ventral tegmental area/midbrain functional connectivity and response to antipsychotic medication in schizophrenia
Impairment in visual and spatial perception in schizophrenia and delusional disorder
Visual–spatial working memory performance and temporal gray matter volume predict schizotypal personality disorder group membership
The uncinate fasciculus as a predictor of conversion from amnestic mild cognitive impairment to Alzheimer disease
Long-term antipsychotic treatment and brain volumes: a longitudinal study of first-episode schizophrenia
Face and voice expression identification in patients with emotional and behavioral changes following ventral frontal lobe damage
Basal ganglia volume in unmedicated patients with schizophrenia is associated with treatment response to antipsychotic medication
A comparison between voxel-based cortical thickness and voxel-based morphometry in normal aging
Attribute interactions in medical data analysis
Structural MRI-Based Predictions in Patients with Treatment-Refractory Depression (TRD)
Diffusion tensor imaging of the superior longitudinal fasciculus and working memory in recent-onset schizophrenia
Brain volume and dysexecutive behavior in schizophrenia
The positive and negative syndrome scale (PANSS) for schizophrenia
Emotional effect on cognitive control in implicit memory tasks in patients with schizophrenia
Wrappers for feature subset selection
Applications of machine learning and rule induction
Mapping the connectome: multi-level analysis of brain connectivity
Using Locally Weighted Learning to Improve Smoreg for Regression
Short-term effects of antipsychotic treatment on cerebral function in drug-naive first-episode schizophrenia revealed by “resting state” functional magnetic resonance imaging
Negative symptoms in schizophrenia: a review
Predicting long-term outcome of Internet-delivered cognitive behavior therapy for social anxiety disorder using fMRI and support vector machine learning
The WEKA data mining software: an update
Diffusion-weighted imaging tractography-based parcellation of the human parietal cortex and comparison with human and macaque resting-state functional connectivity
Prediction of Relative Solvent Accessibility Using Pace Regression
A comparative study on remote tracking of Parkinsons disease progression using data mining methods
Automated anatomical labeling of the bronchial branch and its application to the virtual bronchoscopy system
Imaging in Erdheim–Chester disease: classic features and new insights
Prediction of illness severity in patients with major depression using structural MR brain scans
Do the hands talk on mind’s behalf? Differences in language ability between left- and right-handed children
Integrating VBM into the General Linear Model with voxelwise anatomical covariates
Diffusion-weighted and dynamic contrast-enhanced MRI of prostate cancer: correlation of quantitative MR parameters with Gleason score and tumor angiogenesis
Relation of prefrontal cortex dysfunction to working memory and symptoms in schizophrenia
Fast Training of Support Vector Machines Using Sequential Minimal Optimization
Functional network organization of the human brain
Predicting individual brain maturity using dynamic functional connectivity
Neuroanatomical circuitry associated with exploratory eye movement in schizophrenia: a voxel-based morphometric study
Neural response to specific components of fearful faces in healthy and schizophrenic adults
Validity of modulation and optimal settings for advanced voxel-based morphometry
An Adaptation of Relief for Attribute Estimation in Regression
Theoretical and empirical analysis of ReliefF and RReliefF
Decreased cerebral activation during CPT performance: structural and functional deficits in schizophrenic patients

Multimodal functional and structural imaging investigations in psychosis research
Voxel-based morphometric multisite collaborative study on schizophrenia
The angular gyrus: multiple functions and multiple subdivisions
White matter damage along the uncinate fasciculus contributes to cognitive decline in AD and DLB
Predicting cognitive decline in subjects at risk for Alzheimer disease by using combined cerebrospinal fluid, MR imaging, and PET biomarkers
Genetic analysis of quantitative phenotypes in AD and MCI: imaging, cognition and biomarkers
A possible role for the striatum in the pathogenesis of the cognitive symptoms of schizophrenia
Liver planning software accurately predicts postoperative liver volume and measures early regeneration
Application of a spatially-weighted Relief algorithm for ranking genetic predictors of disease
Predicting clinical scores from magnetic resonance scans in Alzheimer’s disease
Discriminating schizophrenia and bipolar disorder by fusing fMRI and DTI in a multimodal CCA+ joint ICA model
A review of multivariate methods for multimodal fusion of brain imaging data
Three-way (N-way) fusion of brain imaging data based on mCCA + jICA and its application to discriminating schizophrenia
Function–structure associations of the brain: evidence from multimodal connectivity and covariance studies
In Search of multimodal neuroimaging biomarkers of cognitive deficits in schizophrenia
Iterative RELIEF for feature weighting: algorithms, theories, and applications
White matter changes associated with antipsychotic treatment in first-episode psychosis
Stress sensitivity interacts with depression history to predict depressive symptoms among youth: prospective changes following first depression onset
Regression shrinkage and selection via the lasso

A six stage approach for the diagnosis of the Alzheimer’s disease based on fMRI data
Frontoparietal white matter diffusion properties predict mental arithmetic skills in children
A functional MRI marker may predict the outcome of electroconvulsive therapy in severe and treatment-resistant depression
Replication and extension: separate personality traits from states to predict depression
Cognitive impairment in bipolar disorder and schizophrenia: a systematic review
Identifying the neuroanatomical basis of cognitive impairment in Alzheimer’s disease by correlation- and nonlinearity-aware sparse Bayesian learning

Sparse multi-task regression and feature selection to identify brain imaging predictors for memory performance
Identifying AD-sensitive and cognition-relevant imaging biomarkers via joint classification and regression
Three dysconnectivity patterns in treatment-resistant schizophrenia patients and their unaffected siblings
Anatomic and functional variability: the effects of filter size in group fMRI data analysis
Review of processing and analysis methods for DNA methylation array data
Prognostic classification of mild cognitive impairment and Alzheimer’s disease: MRI independent component analysis
Connectivity-based whole brain dual parcellation by group ICA reveals tract structures and decreased connectivity in schizophrenia
Network-guided sparse learning for predicting cognitive outcomes from MRI measures
Sparse learning and stability selection for predicting MCI to AD conversion using baseline ADNI data
Multi-modal multi-task learning for joint prediction of multiple regression and classification variables in Alzheimer’s disease
Feature Selection and SVM Classification of Multiple Modality Images for Predicting MCI
Appendix A. Supplementary data
Supplementary data to this article can be found online at http://dx.doi.org/10.1016/j.neuroimage.2016.05.026.
The working flowchart of the proposed prediction framework. Fig. 1 shows working flowchart of the proposed prediction model, in which preprocessing, feature selection (ReliefF), spatial clustering, feature subset selection and regression models are employed. Three MRI measures (fALFF, GM, FA) are combined together to realize the individualized prediction via linear or nonlinear regression analysis.
Prediction results based on three multimodal features for MCCB MATRICS. Fig. 2: (A) prediction plot based on the proposed framework, cognitive scores (the MCCB composite) for 47 SZs and 50 HCs were plotted in the x-axis (HC: red dots, SZ: blue dots); the Y-axis represents the predicted values.(B) In the reliability test, 1000 bootstrap resamples were performed to estimate the distribution and 95% confidence intervals of correlation coefficients between cognitive score and neuroimaging.
Identified brain regions that may serve as neuromarkers. Fig. 3 indicates the identified brain clusters of three MRI measures, with the cluster color reflecting its weight and sign, as well as the corresponding regression equation, in which the ultimate correlation with ground truth is 0.7033. In total, 15 clusters were identified, each of which was assigned a weigh that implied how much they contribute to the predicted measure (MCCB composite score). The brain views are left, top and front for each column, respectively.
Demographics and the MCCB scores of the subjects.
Measure	HC	SZ	P*	R*	 	Number	50	47			 	Age	36.7 ± 12.6	35.3 ± 12.6	0.6	0.04	 	Gender	20F/30M	6F/41M	0.01	0.17	 	MCCB	 	 Composite	49.8 ± 10.5	31.3 ± 15.7	1.3E-09	1	 	 Speed of processing	51.9 ± 9.0	35.3 ± 13.7	1.5E-09	0.91	 	 Working memory	46.8 ± 11.4	37.1 ± 14.5	5.3E-04	0.83	 	 Attention/Vigilance	48.3 ± 9.9	36.0 ± 15.1	1.4E-05	0.86	 	 Visual learning	49.3 ± 9.3	36.6 ± 12.6	1.5E-07	0.79	 	 Verbal learning	47.4 ± 8.9	38.0 ± 8.6	8.4E-07	0.8	 	 Social cognition	50.8 + 11.1	40.5 ± 13.0	8.3E-05	0.65	 	 Reasoning/Problem solving	54.2 ± 9.9	46.1 ± 11.7	5.1E-04	0.64	 	PANSS	 	 Positive	NA	15.4 ± 5.9		−0.10	 	 Negative	NA	15.1 ± 5.4		−0.48	 	
MCCB = MATRICS Consensus Cognitive Battery; PANSS = positive and negative syndrome scale. Olanzapine equivalent = olanzapine total (standardized current dose of antipsychotic medication).
P* denotes the significance value of two sample t-tests performed between controls and schizophrenia patients for MCCB scores. R* is the correlation value between MCCB composite score and other measures.
Performance comparison with different feature selection steps and regression models.
Correlation	Proposed + linear reg	Proposed + pace reg	Proposed + SMOreg	SMOreg only	ReliefF + SMOreg	SVR only	 			 	Modality	MCCB composite	 	GM	0.3401	0.5678	0.3152	0.1707	0.3297	0.1689	 	ALFF	0.5213	0.5677	0.5578	0.2411	0.2242	0.2051	 	DTI	0.2813	0.3373	0.3627	−0.0559	0.0992	−0.1390	 	3-WAY	0.6366	0.7033	0.6887	0.2807	0.3579	0.1313	 	Modality	PANSS positive	 	GM	0.6807	0.6972	0.6800	−0.2395	0.6380	−0.2553	 	ALFF	0.616	0.6322	0.6327	0.1071	0.5139	0.0312	 	2-WAY	0.674	0.6668	0.7785	−0.1361	0.6701	−0.2662	 	Modality	PANSS negative	 	GM	0.6143	0.7003	0.7334	−0.3664	0.1733	−0.3594	 	ALFF	0.5561	0.6072	0.7517	−0.0598	0.1257	−0.0552	 	2-WAY	0.6573	0.7073	0.7804	−0.3975	0.2217	−0.3800	 	
Table 2 demonstrates the necessity of the multi-stage feature selection. The first 3 columns show the performance using the proposed feature selection steps (std thresholding + ReliefF + CFS) with different regression models. In addition, we also added the MCCB/PANSS prediction performance using only SVM-type nonlinear regression models (SMOreg) or support vector regression models (SVR) without different feature selection steps. If only employ SVM-based regression, there are tens of thousands of voxels used to build a regression within each modality, resulting in markedly lower correlations between the estimated scores and true MCCB/PANSS scores. We have added these results to the supplementary file to show the necessity of each step in the workflow.
Comparison between AAL-based feature selection with the proposed method.
Methods	AAL + pace regression	AAL + ReliefF + CFS pace regression	AAL + CFS pace regression	AAL + LASSO	Proposed method	 			 	Modality	Correlation between predicted MCCB values and the ground truth	 	ALFF	0.16	0.44	0.40	0.34	0.57	 	GM	0.13	0.26	0.16	0.35	0.57	 	Modality	Root mean squared prediction error (RMSE)	 	ALFF	16.7	14.5	14.8	15.0	13.1	 	GM	16.5	15.5	16.5	15.8	13.4	 	Modality	Normalized root mean square error (NRMSE)	 	ALFF	0.21	0.18	0.19	0.19	0.16	 	GM	0.21	0.19	0.21	0.20	0.17	 	
Anatomical information and the frequency of the identified brain ROI features occurring in 97 loops for MCCB composite prediction (r = 0.7033).
Area	 		Brodmann area	 		Vol (cc) L/R	 		Frequency L/R (x, y, z)	 		 	fMRI	 	Superior temporal gyrus	22	0.0/0.8	NA/0.95 (59, −20, 2)	 	Middle temporal gyrus	21	0.0/0.3	NA/0.94 (59, −20, −3)	 	Middle frontal gyrus	8	0.7/0.0	0.74 (−46, 26, 31)/NA	 	Superior frontal gyrus	6	0.1/0.0	0.50 (−21, 23, 44)/NA	 	Cerebrellum		1.5/0.1	0.44 (−11, −45, −33)/0.21 (13, −45, −33)	 	Parahippocampal gyrus	36	0.4/0.0	0.42 (−27, −35, −12)/NA	 	Cuneus	18, 19	0.0/0.3	NA/0.42 (26, −91, 28)	 	Anterior cingulate	25	0.3/0.0	0.25 (−3, 3, −4)/NA	 	Precentral gyrus	6	0.1/0.0	0.15 (−58, −11, 42)/NA	 	sMRI	 	Inferior parietal lobule	7, 40	0.2/1.0	0.35 (−38, −34, 42)/0.77 (45, −57, 44)	 	Cuneus/Precuneus	7, 18, 31	1.2/0.6	0.63 (−15, −70, 30)/0.63 (27, −97, −1)	 	Middle frontal gyrus	6, 8	0.0/0.6	NA/0.6 (36, 23, 31)	 	Posterior cingulate		0.1/0.0	0.50 (−3, −53, 8)/NA	 	Cerebrellum		6.2/4.6	0.50 (−3, −54, 0)/0.50 (6, −48, 2)	 	Lingual gyrus/fusiform	18, 19	0.6/0.4	0.50 (−18, −69, −10)/0.21 (36, −70, 17)	 	Postcentral gyrus	3	0.8/0.0	0.48 (−50, −17, 30)/NA	 	Parahippocampal gyrus	35	0.1/0.3	0.07 (−35, −11, −18)/0.27 (30, −23, −19)	 	Middle Temporal gyrus	21	0.0/0.7	NA/0.21 (57, −9, −11)	 	Insula	13	0.4/0.0	0.21 (−30, 19, 12)/NA	 	Striatum		0.0/0.2	NA/0.20 (27, 12, 13)	 	
DTI Abbreviation	WM tracts	Vo (cc)	Percent	Frequency (L/R)	 	SLF	Superior longitudinal fasciculus	2.1/8.9	2%/9%	0.71(15, 27, 37)/0.87(47, 22, 18)	 	UF	Uncinate fasciculus	1/0.2	10%/0	0.58(16, 45, 9)/NA	 	ILF	Inferior longitudinal fasciculus	0.3/0	1%/0	0.58(17, 40, 7)/NA	 	CGH	Cingulum (hippocampus)	0.3/0	3%/0	0.57(17, 39, 7)/NA	 	SLFt	SLF (temporal part)	0/0.3	0/18%	NA/0.57(45, 21, 15)	 	CST	Corticospinal tract	1.8/0	5%/0	0.48(18, 22, 4)/NA	 	FM	Forceps minor/major	3.3/2.1	6%/4%	0.45(31, 54, 13)/0.48(33, 11, 29)	 	
Anatomical information and the frequency of the identified brain ROI features occurring in 47 loops for PANSS prediction.
PANSS Positive r = 0.7785	 		 	fMRI_fALFF Area	Brodmann area	Vol (cc) L/R	Frequency L/R (x, y, z)	 	Cingulate gyrus	24	0.2/0.4	0.77 (−12, −6, 27)/0.81. (18, 8, 26)	 	Striatum		2.5/1.7	0.75 (−12, −12, 19)/0.81 (12, 2, 21)	 	Medial/Superior frontal Gyrus	10, 11	0.1/0.7	0.11 (−3, 47, −13)/0.70 (18, 50, −6)	 	Anterior cingulate	34	0.0/0.1	NA (0, 0, 0)/0.70 (15, 47, −6)	 	Cerebellum		0.0/1.0	NA (0, 0, 0)/0.51 (6, −61, −18)	 	Parahippocampal gyrus		0.1/0.0	0.51 (−14, 1, −14)/NA	 	Thalamus		0.6/0.1	0.31 (−9, −27, 9)/0.33 (15, −27, 17)	 	Precuneus/Cuneus	19, 39	0.6/0.0	0.19 (−24, −78, 42)/NA (0, 0, 0)	 	sMRI_GM Area	Brodmann area	Vol (cc)L/R	Frequency L/R (x, y, z)	 	Cerebellum		0.5/3.3	0.94/0.95 (6, −64, −24)	 	Angular gyrus	39	0.2/0.0	0.75 (−36, −61, 35)/NA (0, 0, 0)	 	Precuneus	19, 39	0.4/0.0	0.75 (−39, −64, 36)/NA (0, 0, 0)	 	Inferior parietal lobule	39, 40	0.6/0.3	0.75 (−39, −61, 38)/0.75 (54, −35, 40)	 	Striatum		0.0/0.1	NA (0, 0, 0)/0.72 (12, 16, −4)	 	Superior/Middle frontal gyrus	46	0. 4/0.0	0.65 (−35, 47, −15)/NA	 	Lingual gyrus	17	0.1/0.3	0.23 (−9, −89, 1)/0.38 (9, −89, 1)	 	Middle/Inferior frontal gyrus	6, 10	0.6/0.4	0.15 (−36, 37, 19)/0.09 (36, 10, 54)	 	PANSS Negative r = 0.7804	 	fMRI_fALFF area	Brodmann Area	Vol (cc)L/R	Weights L/R (x, y, z)	 	Parahippocampal gyrus	34	0.3/0.0	0.98 (−21, 1, −11)/NA (0, 0, 0)	 	Medial/Superior frontal gyrus	6	0.4/0.0	0.81 (−9, −5, 52)/NA (0, 0, 0)	 	Cerebrellum		0.5/0.0	0.81(−12, −34, −17)/NA (0, 0, 0)	 	Cingulate Gyrus	24	0.1/0.0	0.53 (−9, −5, 46)/NA (0, 0, 0)	 	Striatum		0.9/0.0	0.19 (−12, 13, −1)/NA (0, 0, 0)	 	sMRI_GM area	Brodmann Area	Vol (cc)L/R	Weights L/R (x, y, z)	 	Striatum		0.0/0.5	NA (0, 0, 0)/0.70 (27, 19, 7)	 	Superior/Middle frontal gyrus	6, 8, 10	1.8/0.0	0.61 (−29, 24, 57)/NA	 	Cerebellum		0.4/1.2	0.53(−24, −64, −20)/0.56(12, −70, −22)	 	Angular gyrus/precuneus	39, 40	2.8/0.0	0.56 (−53, −67, 37)/NA	 	Fusiform/Inferior temporal	20	0.0/0.4	NA (0, 0, 0)/0.33 (57, −29, −19)	 	
